/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/cart/route";
exports.ids = ["app/api/cart/route"];
exports.modules = {

/***/ "(rsc)/./app/api/cart/route.ts":
/*!*******************************!*\
  !*** ./app/api/cart/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n\n\n\n// GET cart items\nasync function GET(request) {\n    try {\n        const session = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.auth)();\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized'\n            }, {\n                status: 401\n            });\n        }\n        const cart = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.getCart)(session.user.id);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(cart || []);\n    } catch (error) {\n        console.error('[Cart GET] Error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Gagal mengambil keranjang',\n            details: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n// POST add to cart\nasync function POST(request) {\n    try {\n        const session = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.auth)();\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized'\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { productId, quantity = 1 } = body;\n        if (!productId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Product ID required'\n            }, {\n                status: 400\n            });\n        }\n        if (quantity < 1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Quantity must be at least 1'\n            }, {\n                status: 400\n            });\n        }\n        // SECURITY FIX 1: Validate product exists\n        const product = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.getProductById)(productId);\n        if (!product) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Product not found'\n            }, {\n                status: 404\n            });\n        }\n        // SECURITY FIX 2: Check stock availability\n        if (quantity > product.stock) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: `Only ${product.stock} items available in stock`\n            }, {\n                status: 400\n            });\n        }\n        // SECURITY FIX 3: Prevent abuse with reasonable max limit\n        if (quantity > 100) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Maximum 100 items per transaction'\n            }, {\n                status: 400\n            });\n        }\n        await (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.addToCart)(session.user.id, productId, quantity);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true\n        });\n    } catch (error) {\n        console.error('[Cart POST] Error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Gagal menambah ke keranjang',\n            details: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NhcnQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBdUQ7QUFDdEI7QUFDdUM7QUFFeEUsaUJBQWlCO0FBQ1YsZUFBZUssSUFBSUMsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLE1BQU1DLFVBQVUsTUFBTU4sK0NBQUlBO1FBQzFCLElBQUksQ0FBQ00sU0FBUztZQUNaLE9BQU9QLHFEQUFZQSxDQUFDUSxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQWUsR0FDeEI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1DLE9BQU8sTUFBTVQsZ0RBQU9BLENBQUMsUUFBU1UsSUFBSSxDQUFTQyxFQUFFO1FBQ25ELE9BQU9iLHFEQUFZQSxDQUFDUSxJQUFJLENBQUNHLFFBQVEsRUFBRTtJQUNyQyxFQUFFLE9BQU9GLE9BQU87UUFDZEssUUFBUUwsS0FBSyxDQUFDLHFCQUFxQkE7UUFDbkMsT0FBT1QscURBQVlBLENBQUNRLElBQUksQ0FDdEI7WUFBRUMsT0FBTztZQUE2Qk0sU0FBU0MsT0FBT1A7UUFBTyxHQUM3RDtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLG1CQUFtQjtBQUNaLGVBQWVPLEtBQUtYLE9BQW9CO0lBQzdDLElBQUk7UUFDRixNQUFNQyxVQUFVLE1BQU1OLCtDQUFJQTtRQUMxQixJQUFJLENBQUNNLFNBQVM7WUFDWixPQUFPUCxxREFBWUEsQ0FBQ1EsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFlLEdBQ3hCO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNUSxPQUFPLE1BQU1aLFFBQVFFLElBQUk7UUFDL0IsTUFBTSxFQUFFVyxTQUFTLEVBQUVDLFdBQVcsQ0FBQyxFQUFFLEdBQUdGO1FBRXBDLElBQUksQ0FBQ0MsV0FBVztZQUNkLE9BQU9uQixxREFBWUEsQ0FBQ1EsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFzQixHQUMvQjtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSVUsV0FBVyxHQUFHO1lBQ2hCLE9BQU9wQixxREFBWUEsQ0FBQ1EsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUE4QixHQUN2QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsMENBQTBDO1FBQzFDLE1BQU1XLFVBQVUsTUFBTWpCLHVEQUFjQSxDQUFDZTtRQUNyQyxJQUFJLENBQUNFLFNBQVM7WUFDWixPQUFPckIscURBQVlBLENBQUNRLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBb0IsR0FDN0I7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLDJDQUEyQztRQUMzQyxJQUFJVSxXQUFXQyxRQUFRQyxLQUFLLEVBQUU7WUFDNUIsT0FBT3RCLHFEQUFZQSxDQUFDUSxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPLENBQUMsS0FBSyxFQUFFWSxRQUFRQyxLQUFLLENBQUMseUJBQXlCLENBQUM7WUFBQyxHQUMxRDtnQkFBRVosUUFBUTtZQUFJO1FBRWxCO1FBRUEsMERBQTBEO1FBQzFELElBQUlVLFdBQVcsS0FBSztZQUNsQixPQUFPcEIscURBQVlBLENBQUNRLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBb0MsR0FDN0M7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1QLGtEQUFTQSxDQUFDLFFBQVNTLElBQUksQ0FBU0MsRUFBRSxFQUFFTSxXQUFXQztRQUNyRCxPQUFPcEIscURBQVlBLENBQUNRLElBQUksQ0FBQztZQUFFZSxTQUFTO1FBQUs7SUFDM0MsRUFBRSxPQUFPZCxPQUFPO1FBQ2RLLFFBQVFMLEtBQUssQ0FBQyxzQkFBc0JBO1FBQ3BDLE9BQU9ULHFEQUFZQSxDQUFDUSxJQUFJLENBQ3RCO1lBQUVDLE9BQU87WUFBK0JNLFNBQVNDLE9BQU9QO1FBQU8sR0FDL0Q7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFx4YW1wcFxcaHRkb2NzXFxncmFreSBzdG9yZSB3ZWJcXGFwcFxcYXBpXFxjYXJ0XFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCB7IGF1dGggfSBmcm9tICdAL2xpYi9hdXRoJ1xyXG5pbXBvcnQgeyBnZXRDYXJ0LCBhZGRUb0NhcnQsIGNsZWFyQ2FydCwgZ2V0UHJvZHVjdEJ5SWQgfSBmcm9tICdAL2xpYi9kYidcclxuXHJcbi8vIEdFVCBjYXJ0IGl0ZW1zXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGgoKVxyXG4gICAgaWYgKCFzZXNzaW9uKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2FydCA9IGF3YWl0IGdldENhcnQoKHNlc3Npb24udXNlciBhcyBhbnkpLmlkKVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGNhcnQgfHwgW10pXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tDYXJ0IEdFVF0gRXJyb3I6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdHYWdhbCBtZW5nYW1iaWwga2VyYW5qYW5nJywgZGV0YWlsczogU3RyaW5nKGVycm9yKSB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgIClcclxuICB9XHJcbn1cclxuXHJcbi8vIFBPU1QgYWRkIHRvIGNhcnRcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGgoKVxyXG4gICAgaWYgKCFzZXNzaW9uKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICBjb25zdCB7IHByb2R1Y3RJZCwgcXVhbnRpdHkgPSAxIH0gPSBib2R5XHJcblxyXG4gICAgaWYgKCFwcm9kdWN0SWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdQcm9kdWN0IElEIHJlcXVpcmVkJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHF1YW50aXR5IDwgMSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1F1YW50aXR5IG11c3QgYmUgYXQgbGVhc3QgMScgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFNFQ1VSSVRZIEZJWCAxOiBWYWxpZGF0ZSBwcm9kdWN0IGV4aXN0c1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGdldFByb2R1Y3RCeUlkKHByb2R1Y3RJZClcclxuICAgIGlmICghcHJvZHVjdCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU0VDVVJJVFkgRklYIDI6IENoZWNrIHN0b2NrIGF2YWlsYWJpbGl0eVxyXG4gICAgaWYgKHF1YW50aXR5ID4gcHJvZHVjdC5zdG9jaykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogYE9ubHkgJHtwcm9kdWN0LnN0b2NrfSBpdGVtcyBhdmFpbGFibGUgaW4gc3RvY2tgIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBTRUNVUklUWSBGSVggMzogUHJldmVudCBhYnVzZSB3aXRoIHJlYXNvbmFibGUgbWF4IGxpbWl0XHJcbiAgICBpZiAocXVhbnRpdHkgPiAxMDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdNYXhpbXVtIDEwMCBpdGVtcyBwZXIgdHJhbnNhY3Rpb24nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBhd2FpdCBhZGRUb0NhcnQoKHNlc3Npb24udXNlciBhcyBhbnkpLmlkLCBwcm9kdWN0SWQsIHF1YW50aXR5KVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbQ2FydCBQT1NUXSBFcnJvcjonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0dhZ2FsIG1lbmFtYmFoIGtlIGtlcmFuamFuZycsIGRldGFpbHM6IFN0cmluZyhlcnJvcikgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApXHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJhdXRoIiwiZ2V0Q2FydCIsImFkZFRvQ2FydCIsImdldFByb2R1Y3RCeUlkIiwiR0VUIiwicmVxdWVzdCIsInNlc3Npb24iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJjYXJ0IiwidXNlciIsImlkIiwiY29uc29sZSIsImRldGFpbHMiLCJTdHJpbmciLCJQT1NUIiwiYm9keSIsInByb2R1Y3RJZCIsInF1YW50aXR5IiwicHJvZHVjdCIsInN0b2NrIiwic3VjY2VzcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/cart/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auth: () => (/* binding */ auth),\n/* harmony export */   authConfig: () => (/* binding */ authConfig),\n/* harmony export */   authOptions: () => (/* binding */ authOptions),\n/* harmony export */   handlers: () => (/* binding */ handlers)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _ratelimit__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ratelimit */ \"(rsc)/./lib/ratelimit.ts\");\n/* harmony import */ var _validation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./validation */ \"(rsc)/./lib/validation.ts\");\n\n\n\n\n\n\n\nconst IS_DEV = \"development\" === 'development';\n/**\r\n * Delay function to prevent timing attacks\r\n */ const delay = (ms)=>new Promise((resolve)=>setTimeout(resolve, ms));\nconst authConfig = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            name: 'Credentials',\n            credentials: {\n                email: {\n                    label: 'Email',\n                    type: 'email'\n                },\n                password: {\n                    label: 'Password',\n                    type: 'password'\n                }\n            },\n            async authorize (credentials) {\n                if (IS_DEV) console.log('[Auth] Login attempt initiated');\n                if (!credentials?.email || !credentials?.password) {\n                    if (IS_DEV) console.log('[Auth] Missing credentials');\n                    await delay(1000); // Prevent timing attacks\n                    return null;\n                }\n                try {\n                    const email = credentials?.email?.toLowerCase().trim();\n                    const password = credentials?.password;\n                    // Validate email format\n                    if (!email || !(0,_validation__WEBPACK_IMPORTED_MODULE_6__.validateEmail)(email)) {\n                        if (IS_DEV) console.log('[Auth] Invalid email format');\n                        await delay(1000);\n                        return null;\n                    }\n                    // Rate limiting check\n                    const rateLimitOk = _ratelimit__WEBPACK_IMPORTED_MODULE_5__.loginRateLimiter.check(email);\n                    if (!rateLimitOk) {\n                        const resetTime = _ratelimit__WEBPACK_IMPORTED_MODULE_5__.loginRateLimiter.getResetTime(email);\n                        if (IS_DEV) {\n                            console.log(`[Auth] Rate limited. Reset in ${resetTime}s`);\n                        }\n                        await delay(2000); // Extra delay for rate limited requests\n                        return null;\n                    }\n                    // Fetch user with timeout\n                    const userPromise = (0,_db__WEBPACK_IMPORTED_MODULE_4__.getUserByEmail)(email);\n                    const timeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error('Database query timeout')), 5000));\n                    const user = await Promise.race([\n                        userPromise,\n                        timeoutPromise\n                    ]);\n                    if (!user) {\n                        if (IS_DEV) console.log('[Auth] User not found');\n                        await delay(1000); // Consistent timing\n                        return null;\n                    }\n                    // Check if account is locked\n                    if (user.lockoutUntil) {\n                        const lockoutTime = new Date(user.lockoutUntil);\n                        const now = new Date();\n                        if (now < lockoutTime) {\n                            const remainingMs = lockoutTime.getTime() - now.getTime();\n                            const remainingMin = Math.ceil(remainingMs / 60000);\n                            if (IS_DEV) {\n                                console.log(`[Auth] Account locked for ${remainingMin} more minutes`);\n                            }\n                            await delay(2000);\n                            return null;\n                        } else {\n                            // Lockout expired, reset\n                            await (0,_db__WEBPACK_IMPORTED_MODULE_4__.updateUser)(user.id, {\n                                lockoutUntil: null,\n                                failedLoginAttempts: 0\n                            });\n                            user.lockoutUntil = null;\n                            user.failedLoginAttempts = 0;\n                        }\n                    }\n                    // Check if user is active\n                    if (!user.isActive) {\n                        if (IS_DEV) console.log('[Auth] User account is inactive');\n                        await delay(1000);\n                        return null;\n                    }\n                    // Verify password\n                    const isPasswordValid = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_3__.compare)(password, user.password);\n                    if (!isPasswordValid) {\n                        // Increment failed attempts\n                        const newAttempts = (user.failedLoginAttempts || 0) + 1;\n                        if (newAttempts >= 5) {\n                            // Lock account for 15 minutes\n                            const lockoutUntil = new Date(Date.now() + 15 * 60 * 1000);\n                            // Convert Date to MySQL datetime format\n                            const lockoutDatetime = lockoutUntil.toISOString().slice(0, 19).replace('T', ' ');\n                            await (0,_db__WEBPACK_IMPORTED_MODULE_4__.updateUser)(user.id, {\n                                failedLoginAttempts: newAttempts,\n                                lockoutUntil: lockoutDatetime\n                            });\n                            if (IS_DEV) {\n                                console.log('[Auth] Account locked due to 5 failed attempts');\n                            }\n                        } else {\n                            await (0,_db__WEBPACK_IMPORTED_MODULE_4__.updateUser)(user.id, {\n                                failedLoginAttempts: newAttempts\n                            });\n                            if (IS_DEV) {\n                                console.log(`[Auth] Failed attempt ${newAttempts}/5`);\n                            }\n                        }\n                        await delay(1000);\n                        return null;\n                    }\n                    // Password is valid - reset failed attempts and update last login\n                    const lastLogin = new Date().toISOString().slice(0, 19).replace('T', ' ');\n                    await (0,_db__WEBPACK_IMPORTED_MODULE_4__.updateUser)(user.id, {\n                        failedLoginAttempts: 0,\n                        lockoutUntil: null,\n                        lastLoginAt: lastLogin\n                    });\n                    // Reset rate limiter on successful login\n                    _ratelimit__WEBPACK_IMPORTED_MODULE_5__.loginRateLimiter.reset(email);\n                    if (IS_DEV) console.log('[Auth] Login successful');\n                    return {\n                        id: user.id,\n                        email: user.email,\n                        name: user.name,\n                        role: user.role || 'USER'\n                    };\n                } catch (error) {\n                    if (IS_DEV) console.error('[Auth] authorize error:', error);\n                    await delay(1000);\n                    return null;\n                }\n            }\n        }),\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET\n        })\n    ],\n    pages: {\n        signIn: '/auth/login',\n        error: '/auth/login'\n    },\n    callbacks: {\n        async signIn ({ user, account }) {\n            if (account?.provider === 'google') {\n                try {\n                    const { email, name } = user;\n                    const existingUser = await (0,_db__WEBPACK_IMPORTED_MODULE_4__.getUserByEmail)(email);\n                    if (!existingUser) {\n                        // Create new user if not exists\n                        const randomPassword = Math.random().toString(36).slice(-8);\n                        const hashedPassword = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_3__.hash)(randomPassword, 10);\n                        const newUser = await (0,_db__WEBPACK_IMPORTED_MODULE_4__.createUser)(name, email, hashedPassword, 'USER');\n                        user.id = newUser.id;\n                        user.role = newUser.role;\n                    } else {\n                        user.id = existingUser.id;\n                        user.role = existingUser.role;\n                    }\n                    return true;\n                } catch (error) {\n                    console.error('Error in Google signIn:', error);\n                    return false;\n                }\n            }\n            return true;\n        },\n        async jwt ({ token, user }) {\n            try {\n                if (IS_DEV) console.log('[Auth] JWT callback');\n                if (user) {\n                    token.id = user.id;\n                    token.email = user.email;\n                    token.name = user.name;\n                    token.role = user.role;\n                }\n                return token;\n            } catch (error) {\n                if (IS_DEV) console.error('[Auth] JWT callback error:', error);\n                return token;\n            }\n        },\n        async session ({ session, token }) {\n            try {\n                if (IS_DEV) console.log('[Auth] Session callback');\n                if (session.user) {\n                    session.user.id = token.id;\n                    session.user.email = token.email;\n                    session.user.name = token.name;\n                    session.user.role = token.role;\n                }\n                return session;\n            } catch (error) {\n                if (IS_DEV) console.error('[Auth] Session callback error:', error);\n                return session;\n            }\n        }\n    },\n    session: {\n        strategy: 'jwt',\n        maxAge: 24 * 60 * 60\n    },\n    jwt: {\n        maxAge: 24 * 60 * 60\n    },\n    cookies: {\n        sessionToken: {\n            name:  false ? 0 : 'next-auth.session-token',\n            options: {\n                httpOnly: true,\n                sameSite: 'lax',\n                path: '/',\n                secure: \"development\" === 'production'\n            }\n        }\n    },\n    // Trust host in development, or if explicitly set in production\n    trustHost:  true || 0\n};\nconst { handlers, auth } = (0,next_auth__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(authConfig);\nconst authOptions = authConfig;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzFCZ0MsUUFBUTNDLElBQUksQ0FBQ2xCLEtBQUssR0FBRzRELE1BQU01RCxLQUFLO29CQUNoQzZELFFBQVEzQyxJQUFJLENBQUNwQixJQUFJLEdBQUc4RCxNQUFNOUQsSUFBSTtvQkFDekIrRCxRQUFRM0MsSUFBSSxDQUFTdUIsSUFBSSxHQUFHbUIsTUFBTW5CLElBQUk7Z0JBQzdDO2dCQUNBLE9BQU9vQjtZQUNULEVBQUUsT0FBT25CLE9BQU87Z0JBQ2QsSUFBSXJELFFBQVFnQixRQUFRcUMsS0FBSyxDQUFDLGtDQUFrQ0E7Z0JBQzVELE9BQU9tQjtZQUNUO1FBQ0Y7SUFDRjtJQUNBQSxTQUFTO1FBQ1BDLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUs7SUFDcEI7SUFDQUosS0FBSztRQUNISSxRQUFRLEtBQUssS0FBSztJQUNwQjtJQUNBQyxTQUFTO1FBQ1BDLGNBQWM7WUFDWm5FLE1BQU1SLE1BQXFDLEdBQ3ZDLENBQWtDLEdBQ2xDO1lBQ0o0RSxTQUFTO2dCQUNQQyxVQUFVO2dCQUNWQyxVQUFVO2dCQUNWQyxNQUFNO2dCQUNOQyxRQUFRaEYsa0JBQXlCO1lBQ25DO1FBQ0Y7SUFDRjtJQUNBLGdFQUFnRTtJQUNoRWlGLFdBQVdqRixLQUFzQyxJQUFJQSxDQUFzQztBQUM3RixFQUFDO0FBRU0sTUFBTSxFQUFFbUYsUUFBUSxFQUFFQyxJQUFJLEVBQUUsR0FBRy9GLHFEQUFRQSxDQUFDaUIsWUFBVztBQUMvQyxNQUFNK0UsY0FBYy9FLFdBQVUiLCJzb3VyY2VzIjpbIkM6XFx4YW1wcFxcaHRkb2NzXFxncmFreSBzdG9yZSB3ZWJcXGxpYlxcYXV0aC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBdXRoQ29uZmlnIH0gZnJvbSAnbmV4dC1hdXRoJ1xyXG5pbXBvcnQgTmV4dEF1dGggZnJvbSAnbmV4dC1hdXRoJ1xyXG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJ1xyXG5pbXBvcnQgR29vZ2xlUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGUnXHJcbmltcG9ydCB7IGNvbXBhcmUsIGhhc2ggfSBmcm9tICdiY3J5cHRqcydcclxuaW1wb3J0IHsgZ2V0VXNlckJ5RW1haWwsIGNyZWF0ZVVzZXIsIHVwZGF0ZVVzZXIgfSBmcm9tICcuL2RiJ1xyXG5pbXBvcnQgeyBsb2dpblJhdGVMaW1pdGVyIH0gZnJvbSAnLi9yYXRlbGltaXQnXHJcbmltcG9ydCB7IHZhbGlkYXRlRW1haWwsIHZhbGlkYXRlUGFzc3dvcmQgfSBmcm9tICcuL3ZhbGlkYXRpb24nXHJcblxyXG5jb25zdCBJU19ERVYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50J1xyXG5cclxuLyoqXHJcbiAqIERlbGF5IGZ1bmN0aW9uIHRvIHByZXZlbnQgdGltaW5nIGF0dGFja3NcclxuICovXHJcbmNvbnN0IGRlbGF5ID0gKG1zOiBudW1iZXIpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpXHJcblxyXG5leHBvcnQgY29uc3QgYXV0aENvbmZpZzogTmV4dEF1dGhDb25maWcgPSB7XHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcclxuICAgICAgbmFtZTogJ0NyZWRlbnRpYWxzJyxcclxuICAgICAgY3JlZGVudGlhbHM6IHtcclxuICAgICAgICBlbWFpbDogeyBsYWJlbDogJ0VtYWlsJywgdHlwZTogJ2VtYWlsJyB9LFxyXG4gICAgICAgIHBhc3N3b3JkOiB7IGxhYmVsOiAnUGFzc3dvcmQnLCB0eXBlOiAncGFzc3dvcmQnIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xyXG4gICAgICAgIGlmIChJU19ERVYpIGNvbnNvbGUubG9nKCdbQXV0aF0gTG9naW4gYXR0ZW1wdCBpbml0aWF0ZWQnKVxyXG5cclxuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5lbWFpbCB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XHJcbiAgICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmxvZygnW0F1dGhdIE1pc3NpbmcgY3JlZGVudGlhbHMnKVxyXG4gICAgICAgICAgYXdhaXQgZGVsYXkoMTAwMCkgLy8gUHJldmVudCB0aW1pbmcgYXR0YWNrc1xyXG4gICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBlbWFpbCA9IChjcmVkZW50aWFscyBhcyBhbnkpPy5lbWFpbD8udG9Mb3dlckNhc2UoKS50cmltKClcclxuICAgICAgICAgIGNvbnN0IHBhc3N3b3JkID0gKGNyZWRlbnRpYWxzIGFzIGFueSk/LnBhc3N3b3JkXHJcblxyXG4gICAgICAgICAgLy8gVmFsaWRhdGUgZW1haWwgZm9ybWF0XHJcbiAgICAgICAgICBpZiAoIWVtYWlsIHx8ICF2YWxpZGF0ZUVtYWlsKGVtYWlsKSkge1xyXG4gICAgICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmxvZygnW0F1dGhdIEludmFsaWQgZW1haWwgZm9ybWF0JylcclxuICAgICAgICAgICAgYXdhaXQgZGVsYXkoMTAwMClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBSYXRlIGxpbWl0aW5nIGNoZWNrXHJcbiAgICAgICAgICBjb25zdCByYXRlTGltaXRPayA9IGxvZ2luUmF0ZUxpbWl0ZXIuY2hlY2soZW1haWwpXHJcbiAgICAgICAgICBpZiAoIXJhdGVMaW1pdE9rKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc2V0VGltZSA9IGxvZ2luUmF0ZUxpbWl0ZXIuZ2V0UmVzZXRUaW1lKGVtYWlsKVxyXG4gICAgICAgICAgICBpZiAoSVNfREVWKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtBdXRoXSBSYXRlIGxpbWl0ZWQuIFJlc2V0IGluICR7cmVzZXRUaW1lfXNgKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGF5KDIwMDApIC8vIEV4dHJhIGRlbGF5IGZvciByYXRlIGxpbWl0ZWQgcmVxdWVzdHNcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBGZXRjaCB1c2VyIHdpdGggdGltZW91dFxyXG4gICAgICAgICAgY29uc3QgdXNlclByb21pc2UgPSBnZXRVc2VyQnlFbWFpbChlbWFpbClcclxuICAgICAgICAgIGNvbnN0IHRpbWVvdXRQcm9taXNlID0gbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyeSB0aW1lb3V0JykpLCA1MDAwKVxyXG4gICAgICAgICAgKVxyXG5cclxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBQcm9taXNlLnJhY2UoW3VzZXJQcm9taXNlLCB0aW1lb3V0UHJvbWlzZV0pIGFzIGFueVxyXG5cclxuICAgICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmxvZygnW0F1dGhdIFVzZXIgbm90IGZvdW5kJylcclxuICAgICAgICAgICAgYXdhaXQgZGVsYXkoMTAwMCkgLy8gQ29uc2lzdGVudCB0aW1pbmdcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBhY2NvdW50IGlzIGxvY2tlZFxyXG4gICAgICAgICAgaWYgKHVzZXIubG9ja291dFVudGlsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvY2tvdXRUaW1lID0gbmV3IERhdGUodXNlci5sb2Nrb3V0VW50aWwpXHJcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcclxuXHJcbiAgICAgICAgICAgIGlmIChub3cgPCBsb2Nrb3V0VGltZSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ01zID0gbG9ja291dFRpbWUuZ2V0VGltZSgpIC0gbm93LmdldFRpbWUoKVxyXG4gICAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ01pbiA9IE1hdGguY2VpbChyZW1haW5pbmdNcyAvIDYwMDAwKVxyXG4gICAgICAgICAgICAgIGlmIChJU19ERVYpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbQXV0aF0gQWNjb3VudCBsb2NrZWQgZm9yICR7cmVtYWluaW5nTWlufSBtb3JlIG1pbnV0ZXNgKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBhd2FpdCBkZWxheSgyMDAwKVxyXG4gICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gTG9ja291dCBleHBpcmVkLCByZXNldFxyXG4gICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXIodXNlci5pZCwge1xyXG4gICAgICAgICAgICAgICAgbG9ja291dFVudGlsOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgZmFpbGVkTG9naW5BdHRlbXB0czogMFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgdXNlci5sb2Nrb3V0VW50aWwgPSBudWxsXHJcbiAgICAgICAgICAgICAgdXNlci5mYWlsZWRMb2dpbkF0dGVtcHRzID0gMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBpcyBhY3RpdmVcclxuICAgICAgICAgIGlmICghdXNlci5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmxvZygnW0F1dGhdIFVzZXIgYWNjb3VudCBpcyBpbmFjdGl2ZScpXHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGF5KDEwMDApXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gVmVyaWZ5IHBhc3N3b3JkXHJcbiAgICAgICAgICBjb25zdCBpc1Bhc3N3b3JkVmFsaWQgPSBhd2FpdCBjb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxyXG5cclxuICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XHJcbiAgICAgICAgICAgIC8vIEluY3JlbWVudCBmYWlsZWQgYXR0ZW1wdHNcclxuICAgICAgICAgICAgY29uc3QgbmV3QXR0ZW1wdHMgPSAodXNlci5mYWlsZWRMb2dpbkF0dGVtcHRzIHx8IDApICsgMVxyXG5cclxuICAgICAgICAgICAgaWYgKG5ld0F0dGVtcHRzID49IDUpIHtcclxuICAgICAgICAgICAgICAvLyBMb2NrIGFjY291bnQgZm9yIDE1IG1pbnV0ZXNcclxuICAgICAgICAgICAgICBjb25zdCBsb2Nrb3V0VW50aWwgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgMTUgKiA2MCAqIDEwMDApXHJcbiAgICAgICAgICAgICAgLy8gQ29udmVydCBEYXRlIHRvIE15U1FMIGRhdGV0aW1lIGZvcm1hdFxyXG4gICAgICAgICAgICAgIGNvbnN0IGxvY2tvdXREYXRldGltZSA9IGxvY2tvdXRVbnRpbC50b0lTT1N0cmluZygpLnNsaWNlKDAsIDE5KS5yZXBsYWNlKCdUJywgJyAnKVxyXG4gICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXIodXNlci5pZCwge1xyXG4gICAgICAgICAgICAgICAgZmFpbGVkTG9naW5BdHRlbXB0czogbmV3QXR0ZW1wdHMsXHJcbiAgICAgICAgICAgICAgICBsb2Nrb3V0VW50aWw6IGxvY2tvdXREYXRldGltZVxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgaWYgKElTX0RFVikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tBdXRoXSBBY2NvdW50IGxvY2tlZCBkdWUgdG8gNSBmYWlsZWQgYXR0ZW1wdHMnKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVVc2VyKHVzZXIuaWQsIHsgZmFpbGVkTG9naW5BdHRlbXB0czogbmV3QXR0ZW1wdHMgfSlcclxuICAgICAgICAgICAgICBpZiAoSVNfREVWKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW0F1dGhdIEZhaWxlZCBhdHRlbXB0ICR7bmV3QXR0ZW1wdHN9LzVgKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgZGVsYXkoMTAwMClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBQYXNzd29yZCBpcyB2YWxpZCAtIHJlc2V0IGZhaWxlZCBhdHRlbXB0cyBhbmQgdXBkYXRlIGxhc3QgbG9naW5cclxuICAgICAgICAgIGNvbnN0IGxhc3RMb2dpbiA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxOSkucmVwbGFjZSgnVCcsICcgJylcclxuICAgICAgICAgIGF3YWl0IHVwZGF0ZVVzZXIodXNlci5pZCwge1xyXG4gICAgICAgICAgICBmYWlsZWRMb2dpbkF0dGVtcHRzOiAwLFxyXG4gICAgICAgICAgICBsb2Nrb3V0VW50aWw6IG51bGwsXHJcbiAgICAgICAgICAgIGxhc3RMb2dpbkF0OiBsYXN0TG9naW5cclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgLy8gUmVzZXQgcmF0ZSBsaW1pdGVyIG9uIHN1Y2Nlc3NmdWwgbG9naW5cclxuICAgICAgICAgIGxvZ2luUmF0ZUxpbWl0ZXIucmVzZXQoZW1haWwpXHJcblxyXG4gICAgICAgICAgaWYgKElTX0RFVikgY29uc29sZS5sb2coJ1tBdXRoXSBMb2dpbiBzdWNjZXNzZnVsJylcclxuXHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogdXNlci5pZCxcclxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcclxuICAgICAgICAgICAgcm9sZTogdXNlci5yb2xlIHx8ICdVU0VSJyxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgaWYgKElTX0RFVikgY29uc29sZS5lcnJvcignW0F1dGhdIGF1dGhvcml6ZSBlcnJvcjonLCBlcnJvcilcclxuICAgICAgICAgIGF3YWl0IGRlbGF5KDEwMDApXHJcbiAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH0pLFxyXG4gICAgR29vZ2xlUHJvdmlkZXIoe1xyXG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCxcclxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCxcclxuICAgIH0pLFxyXG4gIF0sXHJcbiAgcGFnZXM6IHtcclxuICAgIHNpZ25JbjogJy9hdXRoL2xvZ2luJyxcclxuICAgIGVycm9yOiAnL2F1dGgvbG9naW4nLFxyXG4gIH0sXHJcbiAgY2FsbGJhY2tzOiB7XHJcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50IH06IGFueSkge1xyXG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgPT09ICdnb29nbGUnKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHsgZW1haWwsIG5hbWUgfSA9IHVzZXJcclxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGdldFVzZXJCeUVtYWlsKGVtYWlsKVxyXG5cclxuICAgICAgICAgIGlmICghZXhpc3RpbmdVc2VyKSB7XHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgdXNlciBpZiBub3QgZXhpc3RzXHJcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbVBhc3N3b3JkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoLTgpXHJcbiAgICAgICAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgaGFzaChyYW5kb21QYXNzd29yZCwgMTApXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1VzZXIgPSBhd2FpdCBjcmVhdGVVc2VyKG5hbWUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZCwgJ1VTRVInKVxyXG4gICAgICAgICAgICB1c2VyLmlkID0gbmV3VXNlci5pZFxyXG4gICAgICAgICAgICB1c2VyLnJvbGUgPSBuZXdVc2VyLnJvbGVcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVzZXIuaWQgPSBleGlzdGluZ1VzZXIuaWRcclxuICAgICAgICAgICAgdXNlci5yb2xlID0gZXhpc3RpbmdVc2VyLnJvbGVcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIEdvb2dsZSBzaWduSW46JywgZXJyb3IpXHJcbiAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRydWVcclxuICAgIH0sXHJcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9OiBhbnkpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmxvZygnW0F1dGhdIEpXVCBjYWxsYmFjaycpXHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgIHRva2VuLmlkID0gdXNlci5pZFxyXG4gICAgICAgICAgdG9rZW4uZW1haWwgPSB1c2VyLmVtYWlsXHJcbiAgICAgICAgICB0b2tlbi5uYW1lID0gdXNlci5uYW1lXHJcbiAgICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0b2tlblxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGlmIChJU19ERVYpIGNvbnNvbGUuZXJyb3IoJ1tBdXRoXSBKV1QgY2FsbGJhY2sgZXJyb3I6JywgZXJyb3IpXHJcbiAgICAgICAgcmV0dXJuIHRva2VuXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfTogYW55KSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKElTX0RFVikgY29uc29sZS5sb2coJ1tBdXRoXSBTZXNzaW9uIGNhbGxiYWNrJylcclxuICAgICAgICBpZiAoc2Vzc2lvbi51c2VyKSB7XHJcbiAgICAgICAgICBzZXNzaW9uLnVzZXIuaWQgPSB0b2tlbi5pZCBhcyBzdHJpbmdcclxuICAgICAgICAgIHNlc3Npb24udXNlci5lbWFpbCA9IHRva2VuLmVtYWlsIGFzIHN0cmluZ1xyXG4gICAgICAgICAgc2Vzc2lvbi51c2VyLm5hbWUgPSB0b2tlbi5uYW1lIGFzIHN0cmluZ1xyXG4gICAgICAgICAgICA7IChzZXNzaW9uLnVzZXIgYXMgYW55KS5yb2xlID0gdG9rZW4ucm9sZSBhcyBzdHJpbmdcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlc3Npb25cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBpZiAoSVNfREVWKSBjb25zb2xlLmVycm9yKCdbQXV0aF0gU2Vzc2lvbiBjYWxsYmFjayBlcnJvcjonLCBlcnJvcilcclxuICAgICAgICByZXR1cm4gc2Vzc2lvblxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2Vzc2lvbjoge1xyXG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxyXG4gICAgbWF4QWdlOiAyNCAqIDYwICogNjAsIC8vIDI0IGhvdXJzXHJcbiAgfSxcclxuICBqd3Q6IHtcclxuICAgIG1heEFnZTogMjQgKiA2MCAqIDYwLFxyXG4gIH0sXHJcbiAgY29va2llczoge1xyXG4gICAgc2Vzc2lvblRva2VuOiB7XHJcbiAgICAgIG5hbWU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbidcclxuICAgICAgICA/ICdfX1NlY3VyZS1uZXh0LWF1dGguc2Vzc2lvbi10b2tlbidcclxuICAgICAgICA6ICduZXh0LWF1dGguc2Vzc2lvbi10b2tlbicsXHJcbiAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICBodHRwT25seTogdHJ1ZSxcclxuICAgICAgICBzYW1lU2l0ZTogJ2xheCcsXHJcbiAgICAgICAgcGF0aDogJy8nLFxyXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfSxcclxuICAvLyBUcnVzdCBob3N0IGluIGRldmVsb3BtZW50LCBvciBpZiBleHBsaWNpdGx5IHNldCBpbiBwcm9kdWN0aW9uXHJcbiAgdHJ1c3RIb3N0OiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCBwcm9jZXNzLmVudi5BVVRIX1RSVVNUX0hPU1QgPT09ICd0cnVlJyxcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHsgaGFuZGxlcnMsIGF1dGggfSA9IE5leHRBdXRoKGF1dGhDb25maWcpXHJcbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9ucyA9IGF1dGhDb25maWdcclxuIl0sIm5hbWVzIjpbIk5leHRBdXRoIiwiQ3JlZGVudGlhbHNQcm92aWRlciIsIkdvb2dsZVByb3ZpZGVyIiwiY29tcGFyZSIsImhhc2giLCJnZXRVc2VyQnlFbWFpbCIsImNyZWF0ZVVzZXIiLCJ1cGRhdGVVc2VyIiwibG9naW5SYXRlTGltaXRlciIsInZhbGlkYXRlRW1haWwiLCJJU19ERVYiLCJwcm9jZXNzIiwiZGVsYXkiLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImF1dGhDb25maWciLCJwcm92aWRlcnMiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwiY29uc29sZSIsImxvZyIsInRvTG93ZXJDYXNlIiwidHJpbSIsInJhdGVMaW1pdE9rIiwiY2hlY2siLCJyZXNldFRpbWUiLCJnZXRSZXNldFRpbWUiLCJ1c2VyUHJvbWlzZSIsInRpbWVvdXRQcm9taXNlIiwiXyIsInJlamVjdCIsIkVycm9yIiwidXNlciIsInJhY2UiLCJsb2Nrb3V0VW50aWwiLCJsb2Nrb3V0VGltZSIsIkRhdGUiLCJub3ciLCJyZW1haW5pbmdNcyIsImdldFRpbWUiLCJyZW1haW5pbmdNaW4iLCJNYXRoIiwiY2VpbCIsImlkIiwiZmFpbGVkTG9naW5BdHRlbXB0cyIsImlzQWN0aXZlIiwiaXNQYXNzd29yZFZhbGlkIiwibmV3QXR0ZW1wdHMiLCJsb2Nrb3V0RGF0ZXRpbWUiLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwicmVwbGFjZSIsImxhc3RMb2dpbiIsImxhc3RMb2dpbkF0IiwicmVzZXQiLCJyb2xlIiwiZXJyb3IiLCJjbGllbnRJZCIsImVudiIsIkdPT0dMRV9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsInBhZ2VzIiwic2lnbkluIiwiY2FsbGJhY2tzIiwiYWNjb3VudCIsInByb3ZpZGVyIiwiZXhpc3RpbmdVc2VyIiwicmFuZG9tUGFzc3dvcmQiLCJyYW5kb20iLCJ0b1N0cmluZyIsImhhc2hlZFBhc3N3b3JkIiwibmV3VXNlciIsImp3dCIsInRva2VuIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwiY29va2llcyIsInNlc3Npb25Ub2tlbiIsIm9wdGlvbnMiLCJodHRwT25seSIsInNhbWVTaXRlIiwicGF0aCIsInNlY3VyZSIsInRydXN0SG9zdCIsIkFVVEhfVFJVU1RfSE9TVCIsImhhbmRsZXJzIiwiYXV0aCIsImF1dGhPcHRpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addToCart: () => (/* binding */ addToCart),\n/* harmony export */   clearCart: () => (/* binding */ clearCart),\n/* harmony export */   createOrder: () => (/* binding */ createOrder),\n/* harmony export */   createProduct: () => (/* binding */ createProduct),\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   deleteOrder: () => (/* binding */ deleteOrder),\n/* harmony export */   deleteProduct: () => (/* binding */ deleteProduct),\n/* harmony export */   deleteUser: () => (/* binding */ deleteUser),\n/* harmony export */   getAllOrders: () => (/* binding */ getAllOrders),\n/* harmony export */   getAllProducts: () => (/* binding */ getAllProducts),\n/* harmony export */   getAllUsers: () => (/* binding */ getAllUsers),\n/* harmony export */   getCart: () => (/* binding */ getCart),\n/* harmony export */   getCategories: () => (/* binding */ getCategories),\n/* harmony export */   getOrderById: () => (/* binding */ getOrderById),\n/* harmony export */   getOrders: () => (/* binding */ getOrders),\n/* harmony export */   getProductById: () => (/* binding */ getProductById),\n/* harmony export */   getProductsByUserId: () => (/* binding */ getProductsByUserId),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   initializeDatabase: () => (/* binding */ initializeDatabase),\n/* harmony export */   removeFromCart: () => (/* binding */ removeFromCart),\n/* harmony export */   updateCartQuantity: () => (/* binding */ updateCartQuantity),\n/* harmony export */   updateOrderDetails: () => (/* binding */ updateOrderDetails),\n/* harmony export */   updateOrderPayment: () => (/* binding */ updateOrderPayment),\n/* harmony export */   updateOrderStatus: () => (/* binding */ updateOrderStatus),\n/* harmony export */   updateProduct: () => (/* binding */ updateProduct),\n/* harmony export */   updateUser: () => (/* binding */ updateUser),\n/* harmony export */   updateUserPasswordByEmail: () => (/* binding */ updateUserPasswordByEmail)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst poolConfig = {\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0,\n    enableKeepAlive: true\n};\nif (process.env.DATABASE_URL) {\n    // TiDB Cloud or remote database - requires SSL\n    poolConfig.ssl = {\n        minVersion: 'TLSv1.2',\n        rejectUnauthorized: true\n    };\n    try {\n        const urlStr = process.env.DATABASE_URL;\n        // Try standard parsing first\n        try {\n            const url = new URL(urlStr);\n            poolConfig.host = url.hostname;\n            poolConfig.user = url.username;\n            poolConfig.password = url.password;\n            poolConfig.database = url.pathname.replace(/^\\//, '');\n            poolConfig.port = parseInt(url.port) || 4000;\n        } catch (parseError) {\n            // Fallback: Manual parsing for passwords with special chars\n            // Format: mysql://user:pass@host:port/db\n            const noProto = urlStr.replace(/^mysql:\\/\\//, '');\n            const lastAt = noProto.lastIndexOf('@');\n            if (lastAt === -1) throw parseError;\n            const creds = noProto.substring(0, lastAt);\n            const address = noProto.substring(lastAt + 1);\n            const firstColon = creds.indexOf(':');\n            poolConfig.user = firstColon === -1 ? creds : creds.substring(0, firstColon);\n            poolConfig.password = firstColon === -1 ? '' : creds.substring(firstColon + 1);\n            // Address part: host:port/db\n            const slashIdx = address.indexOf('/');\n            const hostPort = slashIdx === -1 ? address : address.substring(0, slashIdx);\n            poolConfig.database = slashIdx === -1 ? '' : address.substring(slashIdx + 1).split('?')[0];\n            const colonIdx = hostPort.lastIndexOf(':');\n            if (colonIdx !== -1) {\n                poolConfig.host = hostPort.substring(0, colonIdx);\n                poolConfig.port = parseInt(hostPort.substring(colonIdx + 1)) || 4000;\n            } else {\n                poolConfig.host = hostPort;\n                poolConfig.port = 4000;\n            }\n        }\n        if (!poolConfig.ssl) {\n            poolConfig.ssl = {\n                minVersion: 'TLSv1.2',\n                rejectUnauthorized: true\n            };\n        }\n    } catch (e) {\n        console.error('Invalid DATABASE_URL:', e);\n    }\n} else {\n    // Local MySQL - no SSL required\n    poolConfig.host = process.env.DB_HOST || 'localhost';\n    poolConfig.user = process.env.DB_USER || 'root';\n    poolConfig.password = process.env.DB_PASSWORD || '';\n    poolConfig.database = process.env.DB_NAME || 'graky_store';\n    poolConfig.port = parseInt(process.env.DB_PORT || '3306');\n    // Explicitly disable SSL for localhost\n    poolConfig.ssl = false;\n}\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createPool(poolConfig);\nlet isInitialized = false;\nlet initPromise = null;\n// Initialize database tables\nasync function initializeDatabase() {\n    if (isInitialized) return;\n    // Prevent concurrent initialization calls\n    if (initPromise) return initPromise;\n    initPromise = (async ()=>{\n        const connection = await pool.getConnection();\n        try {\n            // Check if tables exist, if not create them\n            await connection.query(`\n        CREATE TABLE IF NOT EXISTS users (\n        id VARCHAR(36) PRIMARY KEY,\n        name VARCHAR(100) NOT NULL,\n        email VARCHAR(255) UNIQUE NOT NULL,\n        password VARCHAR(255) NOT NULL,\n        role ENUM('ADMIN', 'KARYAWAN', 'USER') DEFAULT 'USER',\n        isActive BOOLEAN DEFAULT true,\n        failedLoginAttempts INT DEFAULT 0,\n        lockoutUntil DATETIME NULL,\n        lastLoginAt DATETIME NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n        INDEX idx_email (email),\n        INDEX idx_role (role)\n      )\n    `);\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS categories (\n        id VARCHAR(36) PRIMARY KEY,\n        name VARCHAR(100) UNIQUE NOT NULL,\n        icon VARCHAR(50) NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n      )\n    `);\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS products (\n        id VARCHAR(36) PRIMARY KEY,\n        name VARCHAR(255) NOT NULL,\n        categoryId VARCHAR(36) NOT NULL,\n        description LONGTEXT NOT NULL,\n        sizes VARCHAR(255) NOT NULL,\n        \\`condition\\` VARCHAR(10) NOT NULL,\n        price INT NOT NULL,\n        stock INT NOT NULL DEFAULT 0,\n        photoUrl VARCHAR(500),\n        userId VARCHAR(36) NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n        FOREIGN KEY (categoryId) REFERENCES categories(id) ON DELETE CASCADE,\n        FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_categoryId (categoryId),\n        INDEX idx_userId (userId),\n        INDEX idx_createdAt (createdAt)\n      )\n    `);\n            // Add stock column if it doesn't exist (for existing databases)\n            try {\n                await connection.query(`\n        ALTER TABLE products \n        ADD COLUMN IF NOT EXISTS stock INT NOT NULL DEFAULT 0\n      `);\n            } catch (error) {\n                // Column might already exist, ignore error\n                if (!error.message?.includes('Duplicate column name')) {\n                    console.warn('Could not add stock column:', error.message);\n                }\n            }\n            // Add lockout columns if they don't exist (for existing databases)\n            try {\n                await connection.query(`\n        ALTER TABLE users \n        ADD COLUMN IF NOT EXISTS failedLoginAttempts INT DEFAULT 0\n      `);\n                await connection.query(`\n        ALTER TABLE users \n        ADD COLUMN IF NOT EXISTS lockoutUntil DATETIME NULL\n      `);\n                await connection.query(`\n        ALTER TABLE users \n        ADD COLUMN IF NOT EXISTS lastLoginAt DATETIME NULL\n      `);\n            } catch (error) {\n                if (!error.message?.includes('Duplicate column name')) {\n                    console.warn('Could not add lockout columns:', error.message);\n                }\n            }\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS gallery_photos (\n        id VARCHAR(36) PRIMARY KEY,\n        url VARCHAR(500) NOT NULL,\n        productId VARCHAR(36) NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (productId) REFERENCES products(id) ON DELETE CASCADE,\n        INDEX idx_productId (productId)\n      )\n    `);\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS audit_logs (\n        id VARCHAR(36) PRIMARY KEY,\n        action VARCHAR(50) NOT NULL,\n        entity VARCHAR(50) NOT NULL,\n        entityId VARCHAR(36) NOT NULL,\n        changes JSON,\n        userId VARCHAR(36) NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_userId (userId),\n        INDEX idx_createdAt (createdAt)\n      )\n    `);\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS carts (\n        id VARCHAR(36) PRIMARY KEY,\n        userId VARCHAR(36) NOT NULL,\n        productId VARCHAR(36) NOT NULL,\n        quantity INT NOT NULL DEFAULT 1,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n        FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n        FOREIGN KEY (productId) REFERENCES products(id) ON DELETE CASCADE,\n        INDEX idx_userId (userId),\n        INDEX idx_productId (productId)\n      )\n    `);\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS orders (\n        id VARCHAR(36) PRIMARY KEY,\n        userId VARCHAR(36) NOT NULL,\n        totalAmount INT NOT NULL,\n        shippingAddress VARCHAR(255) NOT NULL,\n        shippingCity VARCHAR(100) NOT NULL,\n        shippingPostal VARCHAR(20) NOT NULL,\n        shippingPhone VARCHAR(20) NOT NULL,\n        paymentStatus VARCHAR(20) DEFAULT 'PENDING',\n        orderStatus VARCHAR(20) DEFAULT 'PENDING',\n        paymentId VARCHAR(255) NULL,\n        paymentUrl TEXT NULL,\n        notes TEXT NULL,\n        processedAt DATETIME NULL,\n        processedBy VARCHAR(36) NULL,\n        rating INT NULL,\n        reviewText TEXT NULL,\n        reviewedAt DATETIME NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n        FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_userId (userId),\n        INDEX idx_createdAt (createdAt)\n      )\n    `);\n            // Ensure payment columns exist (for existing databases)\n            try {\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS paymentId VARCHAR(255) NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS paymentUrl TEXT NULL`);\n            } catch (e) {\n                console.warn('Could not ensure payment columns:', e);\n            }\n            await connection.query(`\n      CREATE TABLE IF NOT EXISTS order_items (\n        id VARCHAR(36) PRIMARY KEY,\n        orderId VARCHAR(36) NOT NULL,\n        productId VARCHAR(36) NOT NULL,\n        quantity INT NOT NULL,\n        price INT NOT NULL,\n        createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (orderId) REFERENCES orders(id) ON DELETE CASCADE,\n        FOREIGN KEY (productId) REFERENCES products(id) ON DELETE CASCADE,\n        INDEX idx_orderId (orderId),\n        INDEX idx_productId (productId)\n      )\n    `);\n            // Ensure all order columns exist (best-effort)\n            try {\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS notes TEXT NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS processedAt DATETIME NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS processedBy VARCHAR(36) NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS rating INT NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS reviewText TEXT NULL`);\n                await connection.query(`ALTER TABLE orders ADD COLUMN IF NOT EXISTS reviewedAt DATETIME NULL`);\n            } catch (e) {\n                try {\n                    const [rows] = await connection.query(`SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = ? AND TABLE_NAME = 'orders'`, [\n                        process.env.DB_NAME || 'graky_store'\n                    ]);\n                    const existing = (rows || []).map((r)=>r.COLUMN_NAME);\n                    if (!existing.includes('notes')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN notes TEXT NULL`);\n                    }\n                    if (!existing.includes('processedAt')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN processedAt DATETIME NULL`);\n                    }\n                    if (!existing.includes('processedBy')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN processedBy VARCHAR(36) NULL`);\n                    }\n                    if (!existing.includes('rating')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN rating INT NULL`);\n                    }\n                    if (!existing.includes('reviewText')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN reviewText TEXT NULL`);\n                    }\n                    if (!existing.includes('reviewedAt')) {\n                        await connection.query(`ALTER TABLE orders ADD COLUMN reviewedAt DATETIME NULL`);\n                    }\n                } catch (e2) {\n                    console.warn('Could not ensure order columns (non-fatal):', e2);\n                }\n            }\n            // Insert default categories if not exist\n            const [categories] = await connection.query('SELECT COUNT(*) as count FROM categories');\n            if (categories[0].count === 0) {\n                await connection.query(`\n        INSERT INTO categories (id, name, icon) VALUES\n        ('cat-topi', 'Topi', ''),\n        ('cat-kaos', 'Kaos', ''),\n        ('cat-kemeja', 'Kemeja', ''),\n        ('cat-jacket', 'Jacket', ''),\n        ('cat-hoodie', 'Hoodie', ''),\n        ('cat-jeans', 'Celana Jeans', ''),\n        ('cat-shorts', 'Celana Pendek', ''),\n        ('cat-shoes', 'Sepatu', '')\n      `);\n            }\n            if (true) {\n                console.log(' Database initialized successfully');\n            }\n            isInitialized = true;\n        } catch (error) {\n            console.error(' Database initialization error:', error);\n            throw error;\n        } finally{\n            connection.release();\n        }\n    })();\n    return initPromise;\n}\n// User functions\nasync function createUser(name, email, password, role = 'USER') {\n    const connection = await pool.getConnection();\n    try {\n        // Hash password jika belum ter-hash (use 12 rounds for better security)\n        const hashedPassword = password.startsWith('$2') ? password : await bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().hash(password, 12);\n        const id = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();\n        await connection.query('INSERT INTO users (id, name, email, password, role) VALUES (?, ?, ?, ?, ?)', [\n            id,\n            name,\n            email,\n            hashedPassword,\n            role\n        ]);\n        return {\n            id,\n            name,\n            email,\n            role\n        };\n    } catch (error) {\n        if (error.code === 'ER_DUP_ENTRY') {\n            throw new Error('Email sudah terdaftar');\n        }\n        throw error;\n    } finally{\n        connection.release();\n    }\n}\nasync function getUserByEmail(email) {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query('SELECT * FROM users WHERE email = ?', [\n            email\n        ]);\n        return rows.length > 0 ? rows[0] : null;\n    } finally{\n        connection.release();\n    }\n}\nasync function getUserById(id) {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query('SELECT id, name, email, role, isActive FROM users WHERE id = ?', [\n            id\n        ]);\n        return rows.length > 0 ? rows[0] : null;\n    } finally{\n        connection.release();\n    }\n}\nasync function getAllUsers() {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query('SELECT id, name, email, role, isActive, createdAt FROM users ORDER BY createdAt DESC');\n        return rows;\n    } finally{\n        connection.release();\n    }\n}\nasync function updateUser(id, data) {\n    const connection = await pool.getConnection();\n    try {\n        const fields = Object.keys(data).map((key)=>`${key} = ?`).join(', ');\n        const values = Object.values(data);\n        await connection.query(`UPDATE users SET ${fields}, updatedAt = NOW() WHERE id = ?`, [\n            ...values,\n            id\n        ]);\n        return {\n            id,\n            ...data\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function deleteUser(id) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('DELETE FROM users WHERE id = ?', [\n            id\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\n// Product functions\nasync function createProduct(productData) {\n    const connection = await pool.getConnection();\n    try {\n        const id = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();\n        // Simpan produk\n        await connection.query('INSERT INTO products (id, name, categoryId, description, sizes, `condition`, price, stock, photoUrl, userId) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)', [\n            id,\n            productData.name,\n            productData.categoryId,\n            productData.description,\n            JSON.stringify(productData.sizes),\n            productData.condition,\n            productData.price,\n            productData.stock || 0,\n            productData.photoUrls?.[0] || null,\n            productData.userId\n        ]);\n        // Simpan foto tambahan ke gallery_photos\n        if (productData.photoUrls && productData.photoUrls.length > 1) {\n            for(let i = 1; i < productData.photoUrls.length; i++){\n                await connection.query('INSERT INTO gallery_photos (id, url, productId) VALUES (?, ?, ?)', [\n                    (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),\n                    productData.photoUrls[i],\n                    id\n                ]);\n            }\n        }\n        return {\n            id,\n            ...productData\n        };\n    } finally{\n        connection.release();\n    }\n}\n// GET all products (public)\nasync function getAllProducts() {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query(`SELECT \n        id, name, categoryId, description, sizes, \n        \\`condition\\`, price, stock, photoUrl, userId, createdAt\n       FROM products \n       ORDER BY createdAt DESC`);\n        const products = rows.map((row)=>({\n                id: row.id,\n                name: row.name,\n                categoryId: row.categoryId,\n                description: row.description,\n                condition: row.condition,\n                price: row.price,\n                stock: row.stock ?? 0,\n                sizes: typeof row.sizes === 'string' ? JSON.parse(row.sizes) : row.sizes || [],\n                photoUrl: row.photoUrl,\n                userId: row.userId,\n                createdAt: row.createdAt,\n                rating: 4.5,\n                sold: 0\n            }));\n        // Fetch gallery photos for all products in one query\n        const productIds = products.map((p)=>p.id);\n        if (productIds.length === 0) return [];\n        // Validate all productIds are UUIDs to prevent SQL injection\n        const validProductIds = productIds.filter((id)=>typeof id === 'string' && /^[a-f0-9-]{36}$/i.test(id));\n        let photosByProduct = {};\n        if (validProductIds.length > 0) {\n            const placeholders = validProductIds.map(()=>'?').join(',');\n            const [photosRows] = await connection.query(`SELECT productId, url FROM gallery_photos WHERE productId IN (${placeholders})`, validProductIds);\n            for (const pr of photosRows){\n                photosByProduct[pr.productId] = photosByProduct[pr.productId] || [];\n                photosByProduct[pr.productId].push(pr.url);\n            }\n        }\n        // Build full photoUrls array: primary photoUrl first if exists, then gallery photos\n        return products.map((p)=>{\n            const gallery = photosByProduct[p.id] || [];\n            const photoUrls = [];\n            if (p.photoUrl) photoUrls.push(p.photoUrl);\n            photoUrls.push(...gallery);\n            return {\n                id: p.id,\n                name: p.name,\n                categoryId: p.categoryId,\n                description: p.description,\n                condition: p.condition,\n                price: p.price,\n                stock: p.stock ?? 0,\n                sizes: p.sizes,\n                photoUrls,\n                userId: p.userId,\n                createdAt: p.createdAt,\n                rating: p.rating,\n                sold: p.sold\n            };\n        });\n    } catch (error) {\n        console.error('Error getting all products:', error);\n        return [];\n    } finally{\n        connection.release();\n    }\n}\n// GET products by user ID\nasync function getProductsByUserId(userId) {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query(`SELECT \n        id, name, categoryId, description, sizes, \n        \\`condition\\`, price, stock, photoUrl, userId, createdAt\n       FROM products \n       WHERE userId = ?\n       ORDER BY createdAt DESC`, [\n            userId\n        ]);\n        const products = rows.map((row)=>({\n                ...row,\n                sizes: typeof row.sizes === 'string' ? JSON.parse(row.sizes) : row.sizes,\n                stock: row.stock ?? 0,\n                photoUrl: row.photoUrl\n            }));\n        const productIds = products.map((p)=>p.id);\n        if (productIds.length === 0) {\n            return products.map((p)=>({\n                    ...p,\n                    photoUrls: p.photoUrl ? [\n                        p.photoUrl\n                    ] : []\n                }));\n        }\n        // Validate all productIds are UUIDs to prevent SQL injection\n        const validProductIds = productIds.filter((id)=>typeof id === 'string' && /^[a-f0-9-]{36}$/i.test(id));\n        let photosByProduct = {};\n        if (validProductIds.length > 0) {\n            const placeholders = validProductIds.map(()=>'?').join(',');\n            const [photosRows] = await connection.query(`SELECT productId, url FROM gallery_photos WHERE productId IN (${placeholders})`, validProductIds);\n            for (const pr of photosRows){\n                photosByProduct[pr.productId] = photosByProduct[pr.productId] || [];\n                photosByProduct[pr.productId].push(pr.url);\n            }\n        }\n        return products.map((p)=>{\n            const gallery = photosByProduct[p.id] || [];\n            const photoUrls = [];\n            if (p.photoUrl) photoUrls.push(p.photoUrl);\n            photoUrls.push(...gallery);\n            return {\n                ...p,\n                photoUrls\n            };\n        });\n    } catch (error) {\n        console.error('Error getting products by user:', error);\n        return [];\n    } finally{\n        connection.release();\n    }\n}\nasync function getProductById(id) {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query('SELECT * FROM products WHERE id = ?', [\n            id\n        ]);\n        if (rows.length === 0) return null;\n        const row = rows[0];\n        const sizes = typeof row.sizes === 'string' ? JSON.parse(row.sizes) : row.sizes || [];\n        // Fetch gallery photos for this product\n        const [photoRows] = await connection.query('SELECT url FROM gallery_photos WHERE productId = ? ORDER BY createdAt ASC', [\n            id\n        ]);\n        const galleryUrls = (photoRows || []).map((r)=>r.url);\n        const photoUrls = [];\n        if (row.photoUrl) photoUrls.push(row.photoUrl);\n        photoUrls.push(...galleryUrls);\n        return {\n            ...row,\n            sizes,\n            photoUrls,\n            stock: row.stock ?? 0,\n            rating: 4.5,\n            sold: 0\n        };\n    } catch (error) {\n        console.error('Error getting product by ID:', error);\n        return null;\n    } finally{\n        connection.release();\n    }\n}\nasync function updateProduct(id, data) {\n    const connection = await pool.getConnection();\n    try {\n        // Prepare update fields\n        const updateFields = [];\n        const values = [];\n        // Handle each field\n        if (data.name !== undefined) {\n            updateFields.push('name = ?');\n            values.push(data.name);\n        }\n        if (data.categoryId !== undefined) {\n            updateFields.push('categoryId = ?');\n            values.push(data.categoryId);\n        }\n        if (data.description !== undefined) {\n            updateFields.push('description = ?');\n            values.push(data.description);\n        }\n        if (data.condition !== undefined) {\n            updateFields.push('`condition` = ?');\n            values.push(data.condition);\n        }\n        if (data.price !== undefined) {\n            updateFields.push('price = ?');\n            values.push(data.price);\n        }\n        if (data.stock !== undefined) {\n            updateFields.push('stock = ?');\n            values.push(data.stock);\n        }\n        if (data.sizes !== undefined) {\n            updateFields.push('sizes = ?');\n            values.push(JSON.stringify(data.sizes));\n        }\n        // If photoUrls provided, set primary photo (first) in products.photoUrl\n        if (data.photoUrls !== undefined) {\n            const primary = data.photoUrls.length > 0 ? data.photoUrls[0] : null;\n            updateFields.push('photoUrl = ?');\n            values.push(primary);\n        }\n        // Always update timestamp\n        updateFields.push('updatedAt = NOW()');\n        // Add product id as last parameter\n        values.push(id);\n        if (updateFields.length > 1) {\n            const query = `UPDATE products SET ${updateFields.join(', ')} WHERE id = ?`;\n            await connection.query(query, values);\n        }\n        // If photoUrls provided, synchronize gallery_photos:\n        if (data.photoUrls !== undefined) {\n            // Remove existing gallery photos for this product\n            await connection.query('DELETE FROM gallery_photos WHERE productId = ?', [\n                id\n            ]);\n            // Insert remaining photos (from index 1..)\n            if (data.photoUrls.length > 1) {\n                const inserts = [];\n                for(let i = 1; i < data.photoUrls.length; i++){\n                    inserts.push([\n                        (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),\n                        data.photoUrls[i],\n                        id\n                    ]);\n                }\n                // Bulk insert\n                const placeholders = inserts.map(()=>'(?, ?, ?)').join(', ');\n                const flatValues = inserts.flat();\n                await connection.query(`INSERT INTO gallery_photos (id, url, productId) VALUES ${placeholders}`, flatValues);\n            }\n        }\n        return {\n            id,\n            ...data\n        };\n    } catch (error) {\n        console.error('Update product error:', error);\n        throw error;\n    } finally{\n        connection.release();\n    }\n}\nasync function deleteProduct(id) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('DELETE FROM products WHERE id = ?', [\n            id\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function getCategories() {\n    const connection = await pool.getConnection();\n    try {\n        const [rows] = await connection.query('SELECT * FROM categories');\n        return Array.isArray(rows) ? rows : [];\n    } catch (error) {\n        console.error('[DB] getCategories error:', error);\n        // Return empty array on error for graceful fallback\n        return [];\n    } finally{\n        connection.release();\n    }\n}\nasync function updateUserPasswordByEmail(email, hashedPassword) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('UPDATE users SET password = ?, updatedAt = NOW() WHERE email = ?', [\n            hashedPassword,\n            email\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\n// Cart functions\nasync function addToCart(userId, productId, quantity = 1) {\n    const connection = await pool.getConnection();\n    try {\n        const id = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();\n        await connection.query('INSERT INTO carts (id, userId, productId, quantity) VALUES (?, ?, ?, ?) ON DUPLICATE KEY UPDATE quantity = quantity + ?', [\n            id,\n            userId,\n            productId,\n            quantity,\n            quantity\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function getCart(userId) {\n    const connection = await pool.getConnection();\n    try {\n        const [cartItems] = await connection.query(`SELECT \n        c.id, c.quantity, \n        p.id as productId, p.name, p.price, p.photoUrl, \n        p.categoryId, p.condition\n      FROM carts c\n      JOIN products p ON c.productId = p.id\n      WHERE c.userId = ?\n      ORDER BY c.createdAt DESC`, [\n            userId\n        ]);\n        return cartItems.map((item)=>({\n                cartId: item.id,\n                quantity: item.quantity,\n                product: {\n                    id: item.productId,\n                    name: item.name,\n                    price: item.price,\n                    photoUrl: item.photoUrl,\n                    categoryId: item.categoryId,\n                    condition: item.condition\n                }\n            }));\n    } finally{\n        connection.release();\n    }\n}\nasync function updateCartQuantity(cartId, quantity) {\n    const connection = await pool.getConnection();\n    try {\n        if (quantity <= 0) {\n            await connection.query('DELETE FROM carts WHERE id = ?', [\n                cartId\n            ]);\n        } else {\n            await connection.query('UPDATE carts SET quantity = ? WHERE id = ?', [\n                quantity,\n                cartId\n            ]);\n        }\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function removeFromCart(cartId) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('DELETE FROM carts WHERE id = ?', [\n            cartId\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function clearCart(userId) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('DELETE FROM carts WHERE userId = ?', [\n            userId\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\n// Order functions\nasync function createOrder(userId, cartItems, shippingData) {\n    const connection = await pool.getConnection();\n    try {\n        const orderId = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)();\n        const totalAmount = cartItems.reduce((sum, item)=>sum + item.product.price * item.quantity, 0);\n        await connection.query(`INSERT INTO orders \n        (id, userId, totalAmount, shippingAddress, shippingCity, shippingPostal, \n         shippingPhone, paymentStatus, orderStatus) \n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`, [\n            orderId,\n            userId,\n            totalAmount,\n            shippingData.address,\n            shippingData.city,\n            shippingData.postal,\n            shippingData.phone,\n            'PENDING',\n            'PENDING'\n        ]);\n        // Insert order items\n        for (const item of cartItems){\n            await connection.query(`INSERT INTO order_items (id, orderId, productId, quantity, price)\n         VALUES (?, ?, ?, ?, ?)`, [\n                (0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomUUID)(),\n                orderId,\n                item.product.id,\n                item.quantity,\n                item.product.price\n            ]);\n        }\n        // Clear cart\n        await clearCart(userId);\n        return {\n            orderId,\n            totalAmount\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function getOrders(userId) {\n    const connection = await pool.getConnection();\n    try {\n        const [orders] = await connection.query(`SELECT * FROM orders WHERE userId = ? ORDER BY createdAt DESC`, [\n            userId\n        ]);\n        const ordersWithItems = await Promise.all(orders.map(async (order)=>{\n            const [items] = await connection.query(`SELECT oi.*, p.name, p.photoUrl \n           FROM order_items oi\n           JOIN products p ON oi.productId = p.id\n           WHERE oi.orderId = ?`, [\n                order.id\n            ]);\n            return {\n                ...order,\n                items\n            };\n        }));\n        return ordersWithItems;\n    } finally{\n        connection.release();\n    }\n}\nasync function getOrderById(orderId) {\n    const connection = await pool.getConnection();\n    try {\n        const [orders] = await connection.query(`SELECT o.*, u.id as userId, u.name as userName, u.email as userEmail\n       FROM orders o\n       LEFT JOIN users u ON o.userId = u.id\n       WHERE o.id = ?`, [\n            orderId\n        ]);\n        if (orders.length === 0) return null;\n        const order = orders[0];\n        const [items] = await connection.query(`SELECT oi.*, p.id as productId, p.name, p.price, p.photoUrl \n       FROM order_items oi\n       JOIN products p ON oi.productId = p.id\n       WHERE oi.orderId = ?`, [\n            orderId\n        ]);\n        return {\n            ...order,\n            user: {\n                id: order.userId,\n                name: order.userName,\n                email: order.userEmail\n            },\n            items: items.map((item)=>({\n                    id: item.id,\n                    quantity: item.quantity,\n                    price: item.price,\n                    product: {\n                        id: item.productId,\n                        name: item.name\n                    }\n                }))\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function updateOrderPayment(orderId, paymentId, paymentUrl) {\n    const connection = await pool.getConnection();\n    try {\n        await connection.query('UPDATE orders SET paymentId = ?, paymentUrl = ?, updatedAt = NOW() WHERE id = ?', [\n            paymentId,\n            paymentUrl,\n            orderId\n        ]);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function updateOrderStatus(orderId, status, paymentStatus) {\n    const connection = await pool.getConnection();\n    try {\n        const updates = [\n            'orderStatus = ?'\n        ];\n        const values = [\n            status\n        ];\n        if (paymentStatus) {\n            updates.push('paymentStatus = ?');\n            values.push(paymentStatus);\n        }\n        values.push(orderId);\n        await connection.query(`UPDATE orders SET ${updates.join(', ')}, updatedAt = NOW() WHERE id = ?`, values);\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function getAllOrders(page = 1, limit = 10, status = 'ALL') {\n    const connection = await pool.getConnection();\n    try {\n        const offset = (page - 1) * limit;\n        let whereClause = '';\n        const params = [];\n        if (status !== 'ALL') {\n            whereClause = 'WHERE o.orderStatus = ?';\n            params.push(status);\n        }\n        // Get total count\n        const [countResult] = await connection.query(`SELECT COUNT(*) as total FROM orders o ${whereClause}`, params);\n        const totalOrders = countResult[0]?.total || 0;\n        const totalPages = Math.ceil(totalOrders / limit);\n        // Get paginated orders with user info\n        const [orders] = await connection.query(`SELECT o.*, u.name as user_name, u.email as user_email\n       FROM orders o\n       LEFT JOIN users u ON o.userId = u.id\n       ${whereClause}\n       ORDER BY o.createdAt DESC\n       LIMIT ? OFFSET ?`, [\n            ...params,\n            limit,\n            offset\n        ]);\n        // Format response\n        const formattedOrders = orders.map((order)=>({\n                id: order.id,\n                totalAmount: order.totalAmount,\n                orderStatus: order.orderStatus,\n                paymentStatus: order.paymentStatus,\n                shippingCity: order.shippingCity,\n                user: {\n                    name: order.user_name,\n                    email: order.user_email\n                },\n                createdAt: order.createdAt,\n                items: [] // Will be populated if needed\n            }));\n        return {\n            orders: formattedOrders,\n            totalPages,\n            currentPage: page,\n            totalOrders\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function updateOrderDetails(id, data) {\n    const connection = await pool.getConnection();\n    try {\n        const updateFields = [];\n        const values = [];\n        if (data.orderStatus) {\n            updateFields.push('orderStatus = ?');\n            values.push(data.orderStatus);\n        }\n        if (data.paymentStatus) {\n            updateFields.push('paymentStatus = ?');\n            values.push(data.paymentStatus);\n        }\n        if (data.notes !== undefined) {\n            updateFields.push('notes = ?');\n            values.push(data.notes);\n        }\n        if (data.processedBy) {\n            updateFields.push('processedBy = ?');\n            values.push(data.processedBy);\n            updateFields.push('processedAt = NOW()');\n        }\n        // Always update timestamp\n        updateFields.push('updatedAt = NOW()');\n        values.push(id);\n        if (updateFields.length > 1) {\n            const query = `UPDATE orders SET ${updateFields.join(', ')} WHERE id = ?`;\n            await connection.query(query, values);\n        }\n        return {\n            success: true\n        };\n    } finally{\n        connection.release();\n    }\n}\nasync function deleteOrder(id) {\n    const connection = await pool.getConnection();\n    try {\n        // Delete order items first (foreign key constraint)\n        await connection.query('DELETE FROM order_items WHERE orderId = ?', [\n            id\n        ]);\n        // Delete order\n        const [result] = await connection.query('DELETE FROM orders WHERE id = ?', [\n            id\n        ]);\n        return {\n            success: result.affectedRows > 0\n        };\n    } finally{\n        connection.release();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFO0lBQzVDLFNBQVU7UUFDUnBKLFdBQVdlLE9BQU87SUFDcEI7QUFDRiIsInNvdXJjZXMiOlsiQzpcXHhhbXBwXFxodGRvY3NcXGdyYWt5IHN0b3JlIHdlYlxcbGliXFxkYi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXlzcWwgZnJvbSAnbXlzcWwyL3Byb21pc2UnXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSAnY3J5cHRvJ1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcydcblxuY29uc3QgcG9vbENvbmZpZzogYW55ID0ge1xuICB3YWl0Rm9yQ29ubmVjdGlvbnM6IHRydWUsXG4gIGNvbm5lY3Rpb25MaW1pdDogMTAsIC8vIEluY3JlYXNlZCBmb3IgYnVpbGQgcHJvY2Vzc1xuICBxdWV1ZUxpbWl0OiAwLCAvLyBVbmxpbWl0ZWQgcXVldWVcbiAgZW5hYmxlS2VlcEFsaXZlOiB0cnVlLFxufVxuXG5pZiAocHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB7XG4gIC8vIFRpREIgQ2xvdWQgb3IgcmVtb3RlIGRhdGFiYXNlIC0gcmVxdWlyZXMgU1NMXG4gIHBvb2xDb25maWcuc3NsID0ge1xuICAgIG1pblZlcnNpb246ICdUTFN2MS4yJyxcbiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IHRydWUsXG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHVybFN0ciA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcbiAgICAvLyBUcnkgc3RhbmRhcmQgcGFyc2luZyBmaXJzdFxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHVybFN0cik7XG4gICAgICBwb29sQ29uZmlnLmhvc3QgPSB1cmwuaG9zdG5hbWU7XG4gICAgICBwb29sQ29uZmlnLnVzZXIgPSB1cmwudXNlcm5hbWU7XG4gICAgICBwb29sQ29uZmlnLnBhc3N3b3JkID0gdXJsLnBhc3N3b3JkO1xuICAgICAgcG9vbENvbmZpZy5kYXRhYmFzZSA9IHVybC5wYXRobmFtZS5yZXBsYWNlKC9eXFwvLywgJycpO1xuICAgICAgcG9vbENvbmZpZy5wb3J0ID0gcGFyc2VJbnQodXJsLnBvcnQpIHx8IDQwMDA7XG4gICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgLy8gRmFsbGJhY2s6IE1hbnVhbCBwYXJzaW5nIGZvciBwYXNzd29yZHMgd2l0aCBzcGVjaWFsIGNoYXJzXG4gICAgICAvLyBGb3JtYXQ6IG15c3FsOi8vdXNlcjpwYXNzQGhvc3Q6cG9ydC9kYlxuICAgICAgY29uc3Qgbm9Qcm90byA9IHVybFN0ci5yZXBsYWNlKC9ebXlzcWw6XFwvXFwvLywgJycpO1xuICAgICAgY29uc3QgbGFzdEF0ID0gbm9Qcm90by5sYXN0SW5kZXhPZignQCcpO1xuICAgICAgaWYgKGxhc3RBdCA9PT0gLTEpIHRocm93IHBhcnNlRXJyb3I7XG5cbiAgICAgIGNvbnN0IGNyZWRzID0gbm9Qcm90by5zdWJzdHJpbmcoMCwgbGFzdEF0KTtcbiAgICAgIGNvbnN0IGFkZHJlc3MgPSBub1Byb3RvLnN1YnN0cmluZyhsYXN0QXQgKyAxKTtcblxuICAgICAgY29uc3QgZmlyc3RDb2xvbiA9IGNyZWRzLmluZGV4T2YoJzonKTtcbiAgICAgIHBvb2xDb25maWcudXNlciA9IGZpcnN0Q29sb24gPT09IC0xID8gY3JlZHMgOiBjcmVkcy5zdWJzdHJpbmcoMCwgZmlyc3RDb2xvbik7XG4gICAgICBwb29sQ29uZmlnLnBhc3N3b3JkID0gZmlyc3RDb2xvbiA9PT0gLTEgPyAnJyA6IGNyZWRzLnN1YnN0cmluZyhmaXJzdENvbG9uICsgMSk7XG5cbiAgICAgIC8vIEFkZHJlc3MgcGFydDogaG9zdDpwb3J0L2RiXG4gICAgICBjb25zdCBzbGFzaElkeCA9IGFkZHJlc3MuaW5kZXhPZignLycpO1xuICAgICAgY29uc3QgaG9zdFBvcnQgPSBzbGFzaElkeCA9PT0gLTEgPyBhZGRyZXNzIDogYWRkcmVzcy5zdWJzdHJpbmcoMCwgc2xhc2hJZHgpO1xuICAgICAgcG9vbENvbmZpZy5kYXRhYmFzZSA9IHNsYXNoSWR4ID09PSAtMSA/ICcnIDogYWRkcmVzcy5zdWJzdHJpbmcoc2xhc2hJZHggKyAxKS5zcGxpdCgnPycpWzBdO1xuXG4gICAgICBjb25zdCBjb2xvbklkeCA9IGhvc3RQb3J0Lmxhc3RJbmRleE9mKCc6Jyk7XG4gICAgICBpZiAoY29sb25JZHggIT09IC0xKSB7XG4gICAgICAgIHBvb2xDb25maWcuaG9zdCA9IGhvc3RQb3J0LnN1YnN0cmluZygwLCBjb2xvbklkeCk7XG4gICAgICAgIHBvb2xDb25maWcucG9ydCA9IHBhcnNlSW50KGhvc3RQb3J0LnN1YnN0cmluZyhjb2xvbklkeCArIDEpKSB8fCA0MDAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcG9vbENvbmZpZy5ob3N0ID0gaG9zdFBvcnQ7XG4gICAgICAgIHBvb2xDb25maWcucG9ydCA9IDQwMDA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFwb29sQ29uZmlnLnNzbCkge1xuICAgICAgcG9vbENvbmZpZy5zc2wgPSB7IG1pblZlcnNpb246ICdUTFN2MS4yJywgcmVqZWN0VW5hdXRob3JpemVkOiB0cnVlIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIERBVEFCQVNFX1VSTDonLCBlKVxuICB9XG59IGVsc2Uge1xuICAvLyBMb2NhbCBNeVNRTCAtIG5vIFNTTCByZXF1aXJlZFxuICBwb29sQ29uZmlnLmhvc3QgPSBwcm9jZXNzLmVudi5EQl9IT1NUIHx8ICdsb2NhbGhvc3QnXG4gIHBvb2xDb25maWcudXNlciA9IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgJ3Jvb3QnXG4gIHBvb2xDb25maWcucGFzc3dvcmQgPSBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnJ1xuICBwb29sQ29uZmlnLmRhdGFiYXNlID0gcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCAnZ3Jha3lfc3RvcmUnXG4gIHBvb2xDb25maWcucG9ydCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX1BPUlQgfHwgJzMzMDYnKVxuICAvLyBFeHBsaWNpdGx5IGRpc2FibGUgU1NMIGZvciBsb2NhbGhvc3RcbiAgcG9vbENvbmZpZy5zc2wgPSBmYWxzZVxufVxuXG5jb25zdCBwb29sID0gbXlzcWwuY3JlYXRlUG9vbChwb29sQ29uZmlnKVxuXG5sZXQgaXNJbml0aWFsaXplZCA9IGZhbHNlXG5sZXQgaW5pdFByb21pc2U6IFByb21pc2U8dm9pZD4gfCBudWxsID0gbnVsbFxuXG4vLyBJbml0aWFsaXplIGRhdGFiYXNlIHRhYmxlc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVEYXRhYmFzZSgpIHtcbiAgaWYgKGlzSW5pdGlhbGl6ZWQpIHJldHVyblxuXG4gIC8vIFByZXZlbnQgY29uY3VycmVudCBpbml0aWFsaXphdGlvbiBjYWxsc1xuICBpZiAoaW5pdFByb21pc2UpIHJldHVybiBpbml0UHJvbWlzZVxuXG4gIGluaXRQcm9taXNlID0gKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgaWYgdGFibGVzIGV4aXN0LCBpZiBub3QgY3JlYXRlIHRoZW1cbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoYFxuICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB1c2VycyAoXG4gICAgICAgIGlkIFZBUkNIQVIoMzYpIFBSSU1BUlkgS0VZLFxuICAgICAgICBuYW1lIFZBUkNIQVIoMTAwKSBOT1QgTlVMTCxcbiAgICAgICAgZW1haWwgVkFSQ0hBUigyNTUpIFVOSVFVRSBOT1QgTlVMTCxcbiAgICAgICAgcGFzc3dvcmQgVkFSQ0hBUigyNTUpIE5PVCBOVUxMLFxuICAgICAgICByb2xlIEVOVU0oJ0FETUlOJywgJ0tBUllBV0FOJywgJ1VTRVInKSBERUZBVUxUICdVU0VSJyxcbiAgICAgICAgaXNBY3RpdmUgQk9PTEVBTiBERUZBVUxUIHRydWUsXG4gICAgICAgIGZhaWxlZExvZ2luQXR0ZW1wdHMgSU5UIERFRkFVTFQgMCxcbiAgICAgICAgbG9ja291dFVudGlsIERBVEVUSU1FIE5VTEwsXG4gICAgICAgIGxhc3RMb2dpbkF0IERBVEVUSU1FIE5VTEwsXG4gICAgICAgIGNyZWF0ZWRBdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICB1cGRhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCBPTiBVUERBVEUgQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIElOREVYIGlkeF9lbWFpbCAoZW1haWwpLFxuICAgICAgICBJTkRFWCBpZHhfcm9sZSAocm9sZSlcbiAgICAgIClcbiAgICBgKVxuXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNhdGVnb3JpZXMgKFxuICAgICAgICBpZCBWQVJDSEFSKDM2KSBQUklNQVJZIEtFWSxcbiAgICAgICAgbmFtZSBWQVJDSEFSKDEwMCkgVU5JUVVFIE5PVCBOVUxMLFxuICAgICAgICBpY29uIFZBUkNIQVIoNTApIE5PVCBOVUxMLFxuICAgICAgICBjcmVhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgdXBkYXRlZEF0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAgT04gVVBEQVRFIENVUlJFTlRfVElNRVNUQU1QXG4gICAgICApXG4gICAgYClcblxuICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBwcm9kdWN0cyAoXG4gICAgICAgIGlkIFZBUkNIQVIoMzYpIFBSSU1BUlkgS0VZLFxuICAgICAgICBuYW1lIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgY2F0ZWdvcnlJZCBWQVJDSEFSKDM2KSBOT1QgTlVMTCxcbiAgICAgICAgZGVzY3JpcHRpb24gTE9OR1RFWFQgTk9UIE5VTEwsXG4gICAgICAgIHNpemVzIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgXFxgY29uZGl0aW9uXFxgIFZBUkNIQVIoMTApIE5PVCBOVUxMLFxuICAgICAgICBwcmljZSBJTlQgTk9UIE5VTEwsXG4gICAgICAgIHN0b2NrIElOVCBOT1QgTlVMTCBERUZBVUxUIDAsXG4gICAgICAgIHBob3RvVXJsIFZBUkNIQVIoNTAwKSxcbiAgICAgICAgdXNlcklkIFZBUkNIQVIoMzYpIE5PVCBOVUxMLFxuICAgICAgICBjcmVhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgdXBkYXRlZEF0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAgT04gVVBEQVRFIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBGT1JFSUdOIEtFWSAoY2F0ZWdvcnlJZCkgUkVGRVJFTkNFUyBjYXRlZ29yaWVzKGlkKSBPTiBERUxFVEUgQ0FTQ0FERSxcbiAgICAgICAgRk9SRUlHTiBLRVkgKHVzZXJJZCkgUkVGRVJFTkNFUyB1c2VycyhpZCkgT04gREVMRVRFIENBU0NBREUsXG4gICAgICAgIElOREVYIGlkeF9jYXRlZ29yeUlkIChjYXRlZ29yeUlkKSxcbiAgICAgICAgSU5ERVggaWR4X3VzZXJJZCAodXNlcklkKSxcbiAgICAgICAgSU5ERVggaWR4X2NyZWF0ZWRBdCAoY3JlYXRlZEF0KVxuICAgICAgKVxuICAgIGApXG5cbiAgICAgIC8vIEFkZCBzdG9jayBjb2x1bW4gaWYgaXQgZG9lc24ndCBleGlzdCAoZm9yIGV4aXN0aW5nIGRhdGFiYXNlcylcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoYFxuICAgICAgICBBTFRFUiBUQUJMRSBwcm9kdWN0cyBcbiAgICAgICAgQUREIENPTFVNTiBJRiBOT1QgRVhJU1RTIHN0b2NrIElOVCBOT1QgTlVMTCBERUZBVUxUIDBcbiAgICAgIGApXG4gICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIC8vIENvbHVtbiBtaWdodCBhbHJlYWR5IGV4aXN0LCBpZ25vcmUgZXJyb3JcbiAgICAgICAgaWYgKCFlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnRHVwbGljYXRlIGNvbHVtbiBuYW1lJykpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBhZGQgc3RvY2sgY29sdW1uOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGxvY2tvdXQgY29sdW1ucyBpZiB0aGV5IGRvbid0IGV4aXN0IChmb3IgZXhpc3RpbmcgZGF0YWJhc2VzKVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgXG4gICAgICAgIEFMVEVSIFRBQkxFIHVzZXJzIFxuICAgICAgICBBREQgQ09MVU1OIElGIE5PVCBFWElTVFMgZmFpbGVkTG9naW5BdHRlbXB0cyBJTlQgREVGQVVMVCAwXG4gICAgICBgKVxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgICAgQUxURVIgVEFCTEUgdXNlcnMgXG4gICAgICAgIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyBsb2Nrb3V0VW50aWwgREFURVRJTUUgTlVMTFxuICAgICAgYClcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgXG4gICAgICAgIEFMVEVSIFRBQkxFIHVzZXJzIFxuICAgICAgICBBREQgQ09MVU1OIElGIE5PVCBFWElTVFMgbGFzdExvZ2luQXQgREFURVRJTUUgTlVMTFxuICAgICAgYClcbiAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgaWYgKCFlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnRHVwbGljYXRlIGNvbHVtbiBuYW1lJykpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBhZGQgbG9ja291dCBjb2x1bW5zOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBnYWxsZXJ5X3Bob3RvcyAoXG4gICAgICAgIGlkIFZBUkNIQVIoMzYpIFBSSU1BUlkgS0VZLFxuICAgICAgICB1cmwgVkFSQ0hBUig1MDApIE5PVCBOVUxMLFxuICAgICAgICBwcm9kdWN0SWQgVkFSQ0hBUigzNikgTk9UIE5VTEwsXG4gICAgICAgIGNyZWF0ZWRBdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBGT1JFSUdOIEtFWSAocHJvZHVjdElkKSBSRUZFUkVOQ0VTIHByb2R1Y3RzKGlkKSBPTiBERUxFVEUgQ0FTQ0FERSxcbiAgICAgICAgSU5ERVggaWR4X3Byb2R1Y3RJZCAocHJvZHVjdElkKVxuICAgICAgKVxuICAgIGApXG5cbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoYFxuICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgYXVkaXRfbG9ncyAoXG4gICAgICAgIGlkIFZBUkNIQVIoMzYpIFBSSU1BUlkgS0VZLFxuICAgICAgICBhY3Rpb24gVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgIGVudGl0eSBWQVJDSEFSKDUwKSBOT1QgTlVMTCxcbiAgICAgICAgZW50aXR5SWQgVkFSQ0hBUigzNikgTk9UIE5VTEwsXG4gICAgICAgIGNoYW5nZXMgSlNPTixcbiAgICAgICAgdXNlcklkIFZBUkNIQVIoMzYpIE5PVCBOVUxMLFxuICAgICAgICBjcmVhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgRk9SRUlHTiBLRVkgKHVzZXJJZCkgUkVGRVJFTkNFUyB1c2VycyhpZCkgT04gREVMRVRFIENBU0NBREUsXG4gICAgICAgIElOREVYIGlkeF91c2VySWQgKHVzZXJJZCksXG4gICAgICAgIElOREVYIGlkeF9jcmVhdGVkQXQgKGNyZWF0ZWRBdClcbiAgICAgIClcbiAgICBgKVxuXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNhcnRzIChcbiAgICAgICAgaWQgVkFSQ0hBUigzNikgUFJJTUFSWSBLRVksXG4gICAgICAgIHVzZXJJZCBWQVJDSEFSKDM2KSBOT1QgTlVMTCxcbiAgICAgICAgcHJvZHVjdElkIFZBUkNIQVIoMzYpIE5PVCBOVUxMLFxuICAgICAgICBxdWFudGl0eSBJTlQgTk9UIE5VTEwgREVGQVVMVCAxLFxuICAgICAgICBjcmVhdGVkQXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgdXBkYXRlZEF0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAgT04gVVBEQVRFIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBGT1JFSUdOIEtFWSAodXNlcklkKSBSRUZFUkVOQ0VTIHVzZXJzKGlkKSBPTiBERUxFVEUgQ0FTQ0FERSxcbiAgICAgICAgRk9SRUlHTiBLRVkgKHByb2R1Y3RJZCkgUkVGRVJFTkNFUyBwcm9kdWN0cyhpZCkgT04gREVMRVRFIENBU0NBREUsXG4gICAgICAgIElOREVYIGlkeF91c2VySWQgKHVzZXJJZCksXG4gICAgICAgIElOREVYIGlkeF9wcm9kdWN0SWQgKHByb2R1Y3RJZClcbiAgICAgIClcbiAgICBgKVxuXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIG9yZGVycyAoXG4gICAgICAgIGlkIFZBUkNIQVIoMzYpIFBSSU1BUlkgS0VZLFxuICAgICAgICB1c2VySWQgVkFSQ0hBUigzNikgTk9UIE5VTEwsXG4gICAgICAgIHRvdGFsQW1vdW50IElOVCBOT1QgTlVMTCxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgc2hpcHBpbmdDaXR5IFZBUkNIQVIoMTAwKSBOT1QgTlVMTCxcbiAgICAgICAgc2hpcHBpbmdQb3N0YWwgVkFSQ0hBUigyMCkgTk9UIE5VTEwsXG4gICAgICAgIHNoaXBwaW5nUGhvbmUgVkFSQ0hBUigyMCkgTk9UIE5VTEwsXG4gICAgICAgIHBheW1lbnRTdGF0dXMgVkFSQ0hBUigyMCkgREVGQVVMVCAnUEVORElORycsXG4gICAgICAgIG9yZGVyU3RhdHVzIFZBUkNIQVIoMjApIERFRkFVTFQgJ1BFTkRJTkcnLFxuICAgICAgICBwYXltZW50SWQgVkFSQ0hBUigyNTUpIE5VTEwsXG4gICAgICAgIHBheW1lbnRVcmwgVEVYVCBOVUxMLFxuICAgICAgICBub3RlcyBURVhUIE5VTEwsXG4gICAgICAgIHByb2Nlc3NlZEF0IERBVEVUSU1FIE5VTEwsXG4gICAgICAgIHByb2Nlc3NlZEJ5IFZBUkNIQVIoMzYpIE5VTEwsXG4gICAgICAgIHJhdGluZyBJTlQgTlVMTCxcbiAgICAgICAgcmV2aWV3VGV4dCBURVhUIE5VTEwsXG4gICAgICAgIHJldmlld2VkQXQgREFURVRJTUUgTlVMTCxcbiAgICAgICAgY3JlYXRlZEF0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIHVwZGF0ZWRBdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QIE9OIFVQREFURSBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgRk9SRUlHTiBLRVkgKHVzZXJJZCkgUkVGRVJFTkNFUyB1c2VycyhpZCkgT04gREVMRVRFIENBU0NBREUsXG4gICAgICAgIElOREVYIGlkeF91c2VySWQgKHVzZXJJZCksXG4gICAgICAgIElOREVYIGlkeF9jcmVhdGVkQXQgKGNyZWF0ZWRBdClcbiAgICAgIClcbiAgICBgKVxuXG4gICAgICAvLyBFbnN1cmUgcGF5bWVudCBjb2x1bW5zIGV4aXN0IChmb3IgZXhpc3RpbmcgZGF0YWJhc2VzKVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyBwYXltZW50SWQgVkFSQ0hBUigyNTUpIE5VTExgKVxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBBTFRFUiBUQUJMRSBvcmRlcnMgQUREIENPTFVNTiBJRiBOT1QgRVhJU1RTIHBheW1lbnRVcmwgVEVYVCBOVUxMYClcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3QgZW5zdXJlIHBheW1lbnQgY29sdW1uczonLCBlKVxuICAgICAgfVxuXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIG9yZGVyX2l0ZW1zIChcbiAgICAgICAgaWQgVkFSQ0hBUigzNikgUFJJTUFSWSBLRVksXG4gICAgICAgIG9yZGVySWQgVkFSQ0hBUigzNikgTk9UIE5VTEwsXG4gICAgICAgIHByb2R1Y3RJZCBWQVJDSEFSKDM2KSBOT1QgTlVMTCxcbiAgICAgICAgcXVhbnRpdHkgSU5UIE5PVCBOVUxMLFxuICAgICAgICBwcmljZSBJTlQgTk9UIE5VTEwsXG4gICAgICAgIGNyZWF0ZWRBdCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBGT1JFSUdOIEtFWSAob3JkZXJJZCkgUkVGRVJFTkNFUyBvcmRlcnMoaWQpIE9OIERFTEVURSBDQVNDQURFLFxuICAgICAgICBGT1JFSUdOIEtFWSAocHJvZHVjdElkKSBSRUZFUkVOQ0VTIHByb2R1Y3RzKGlkKSBPTiBERUxFVEUgQ0FTQ0FERSxcbiAgICAgICAgSU5ERVggaWR4X29yZGVySWQgKG9yZGVySWQpLFxuICAgICAgICBJTkRFWCBpZHhfcHJvZHVjdElkIChwcm9kdWN0SWQpXG4gICAgICApXG4gICAgYClcblxuICAgICAgLy8gRW5zdXJlIGFsbCBvcmRlciBjb2x1bW5zIGV4aXN0IChiZXN0LWVmZm9ydClcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoYEFMVEVSIFRBQkxFIG9yZGVycyBBREQgQ09MVU1OIElGIE5PVCBFWElTVFMgbm90ZXMgVEVYVCBOVUxMYClcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyBwcm9jZXNzZWRBdCBEQVRFVElNRSBOVUxMYClcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyBwcm9jZXNzZWRCeSBWQVJDSEFSKDM2KSBOVUxMYClcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyByYXRpbmcgSU5UIE5VTExgKVxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBBTFRFUiBUQUJMRSBvcmRlcnMgQUREIENPTFVNTiBJRiBOT1QgRVhJU1RTIHJldmlld1RleHQgVEVYVCBOVUxMYClcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gSUYgTk9UIEVYSVNUUyByZXZpZXdlZEF0IERBVEVUSU1FIE5VTExgKVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IFtyb3dzXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICAgICAgIGBTRUxFQ1QgQ09MVU1OX05BTUUgRlJPTSBJTkZPUk1BVElPTl9TQ0hFTUEuQ09MVU1OUyBXSEVSRSBUQUJMRV9TQ0hFTUEgPSA/IEFORCBUQUJMRV9OQU1FID0gJ29yZGVycydgLFxuICAgICAgICAgICAgW3Byb2Nlc3MuZW52LkRCX05BTUUgfHwgJ2dyYWt5X3N0b3JlJ11cbiAgICAgICAgICApXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSAocm93cyB8fCBbXSkubWFwKChyOiBhbnkpID0+IHIuQ09MVU1OX05BTUUpXG4gICAgICAgICAgaWYgKCFleGlzdGluZy5pbmNsdWRlcygnbm90ZXMnKSkge1xuICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gbm90ZXMgVEVYVCBOVUxMYClcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFleGlzdGluZy5pbmNsdWRlcygncHJvY2Vzc2VkQXQnKSkge1xuICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gcHJvY2Vzc2VkQXQgREFURVRJTUUgTlVMTGApXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZXhpc3RpbmcuaW5jbHVkZXMoJ3Byb2Nlc3NlZEJ5JykpIHtcbiAgICAgICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoYEFMVEVSIFRBQkxFIG9yZGVycyBBREQgQ09MVU1OIHByb2Nlc3NlZEJ5IFZBUkNIQVIoMzYpIE5VTExgKVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWV4aXN0aW5nLmluY2x1ZGVzKCdyYXRpbmcnKSkge1xuICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gcmF0aW5nIElOVCBOVUxMYClcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFleGlzdGluZy5pbmNsdWRlcygncmV2aWV3VGV4dCcpKSB7XG4gICAgICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBBTFRFUiBUQUJMRSBvcmRlcnMgQUREIENPTFVNTiByZXZpZXdUZXh0IFRFWFQgTlVMTGApXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZXhpc3RpbmcuaW5jbHVkZXMoJ3Jldmlld2VkQXQnKSkge1xuICAgICAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShgQUxURVIgVEFCTEUgb3JkZXJzIEFERCBDT0xVTU4gcmV2aWV3ZWRBdCBEQVRFVElNRSBOVUxMYClcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUyKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3QgZW5zdXJlIG9yZGVyIGNvbHVtbnMgKG5vbi1mYXRhbCk6JywgZTIpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSW5zZXJ0IGRlZmF1bHQgY2F0ZWdvcmllcyBpZiBub3QgZXhpc3RcbiAgICAgIGNvbnN0IFtjYXRlZ29yaWVzXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gY2F0ZWdvcmllcycpXG4gICAgICBpZiAoY2F0ZWdvcmllc1swXS5jb3VudCA9PT0gMCkge1xuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KGBcbiAgICAgICAgSU5TRVJUIElOVE8gY2F0ZWdvcmllcyAoaWQsIG5hbWUsIGljb24pIFZBTFVFU1xuICAgICAgICAoJ2NhdC10b3BpJywgJ1RvcGknLCAn8J+OqScpLFxuICAgICAgICAoJ2NhdC1rYW9zJywgJ0thb3MnLCAn8J+RlScpLFxuICAgICAgICAoJ2NhdC1rZW1lamEnLCAnS2VtZWphJywgJ/CfkZQnKSxcbiAgICAgICAgKCdjYXQtamFja2V0JywgJ0phY2tldCcsICfwn6elJyksXG4gICAgICAgICgnY2F0LWhvb2RpZScsICdIb29kaWUnLCAn8J+OvScpLFxuICAgICAgICAoJ2NhdC1qZWFucycsICdDZWxhbmEgSmVhbnMnLCAn8J+RlicpLFxuICAgICAgICAoJ2NhdC1zaG9ydHMnLCAnQ2VsYW5hIFBlbmRlaycsICfwn6mzJyksXG4gICAgICAgICgnY2F0LXNob2VzJywgJ1NlcGF0dScsICfwn5GfJylcbiAgICAgIGApXG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgICBjb25zb2xlLmxvZygn4pyTIERhdGFiYXNlIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseScpXG4gICAgICB9XG5cbiAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KclyBEYXRhYmFzZSBpbml0aWFsaXphdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gICAgfVxuICB9KSgpXG5cbiAgcmV0dXJuIGluaXRQcm9taXNlXG59XG5cbi8vIFVzZXIgZnVuY3Rpb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlcihuYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcsIHJvbGU6IHN0cmluZyA9ICdVU0VSJykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICAvLyBIYXNoIHBhc3N3b3JkIGppa2EgYmVsdW0gdGVyLWhhc2ggKHVzZSAxMiByb3VuZHMgZm9yIGJldHRlciBzZWN1cml0eSlcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IHBhc3N3b3JkLnN0YXJ0c1dpdGgoJyQyJykgPyBwYXNzd29yZCA6IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMilcblxuICAgIGNvbnN0IGlkID0gcmFuZG9tVVVJRCgpXG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICdJTlNFUlQgSU5UTyB1c2VycyAoaWQsIG5hbWUsIGVtYWlsLCBwYXNzd29yZCwgcm9sZSkgVkFMVUVTICg/LCA/LCA/LCA/LCA/KScsXG4gICAgICBbaWQsIG5hbWUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZCwgcm9sZV1cbiAgICApXG4gICAgcmV0dXJuIHsgaWQsIG5hbWUsIGVtYWlsLCByb2xlIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGlmIChlcnJvci5jb2RlID09PSAnRVJfRFVQX0VOVFJZJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbWFpbCBzdWRhaCB0ZXJkYWZ0YXInKVxuICAgIH1cbiAgICB0aHJvdyBlcnJvclxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJCeUVtYWlsKGVtYWlsOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgW3Jvd3NdOiBhbnkgPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/JyxcbiAgICAgIFtlbWFpbF1cbiAgICApXG4gICAgcmV0dXJuIHJvd3MubGVuZ3RoID4gMCA/IHJvd3NbMF0gOiBudWxsXG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckJ5SWQoaWQ6IHN0cmluZykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCBbcm93c106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAnU0VMRUNUIGlkLCBuYW1lLCBlbWFpbCwgcm9sZSwgaXNBY3RpdmUgRlJPTSB1c2VycyBXSEVSRSBpZCA9ID8nLFxuICAgICAgW2lkXVxuICAgIClcbiAgICByZXR1cm4gcm93cy5sZW5ndGggPiAwID8gcm93c1swXSA6IG51bGxcbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxVc2VycygpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgW3Jvd3NdOiBhbnkgPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCBpZCwgbmFtZSwgZW1haWwsIHJvbGUsIGlzQWN0aXZlLCBjcmVhdGVkQXQgRlJPTSB1c2VycyBPUkRFUiBCWSBjcmVhdGVkQXQgREVTQydcbiAgICApXG4gICAgcmV0dXJuIHJvd3NcbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVVc2VyKGlkOiBzdHJpbmcsIGRhdGE6IGFueSkge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCBmaWVsZHMgPSBPYmplY3Qua2V5cyhkYXRhKS5tYXAoa2V5ID0+IGAke2tleX0gPSA/YCkuam9pbignLCAnKVxuICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMoZGF0YSlcbiAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgYFVQREFURSB1c2VycyBTRVQgJHtmaWVsZHN9LCB1cGRhdGVkQXQgPSBOT1coKSBXSEVSRSBpZCA9ID9gLFxuICAgICAgWy4uLnZhbHVlcywgaWRdXG4gICAgKVxuICAgIHJldHVybiB7IGlkLCAuLi5kYXRhIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVVc2VyKGlkOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnREVMRVRFIEZST00gdXNlcnMgV0hFUkUgaWQgPSA/JywgW2lkXSlcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbi8vIFByb2R1Y3QgZnVuY3Rpb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdChwcm9kdWN0RGF0YTogYW55KSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IGlkID0gcmFuZG9tVVVJRCgpXG5cbiAgICAvLyBTaW1wYW4gcHJvZHVrXG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICdJTlNFUlQgSU5UTyBwcm9kdWN0cyAoaWQsIG5hbWUsIGNhdGVnb3J5SWQsIGRlc2NyaXB0aW9uLCBzaXplcywgYGNvbmRpdGlvbmAsIHByaWNlLCBzdG9jaywgcGhvdG9VcmwsIHVzZXJJZCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/KScsXG4gICAgICBbXG4gICAgICAgIGlkLFxuICAgICAgICBwcm9kdWN0RGF0YS5uYW1lLFxuICAgICAgICBwcm9kdWN0RGF0YS5jYXRlZ29yeUlkLFxuICAgICAgICBwcm9kdWN0RGF0YS5kZXNjcmlwdGlvbixcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkocHJvZHVjdERhdGEuc2l6ZXMpLFxuICAgICAgICBwcm9kdWN0RGF0YS5jb25kaXRpb24sXG4gICAgICAgIHByb2R1Y3REYXRhLnByaWNlLFxuICAgICAgICBwcm9kdWN0RGF0YS5zdG9jayB8fCAwLFxuICAgICAgICBwcm9kdWN0RGF0YS5waG90b1VybHM/LlswXSB8fCBudWxsLCAvLyBTaW1wYW4gZm90byBwZXJ0YW1hIHNlYmFnYWkgcGhvdG9VcmxcbiAgICAgICAgcHJvZHVjdERhdGEudXNlcklkLFxuICAgICAgXVxuICAgIClcblxuICAgIC8vIFNpbXBhbiBmb3RvIHRhbWJhaGFuIGtlIGdhbGxlcnlfcGhvdG9zXG4gICAgaWYgKHByb2R1Y3REYXRhLnBob3RvVXJscyAmJiBwcm9kdWN0RGF0YS5waG90b1VybHMubGVuZ3RoID4gMSkge1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBwcm9kdWN0RGF0YS5waG90b1VybHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICAgICAnSU5TRVJUIElOVE8gZ2FsbGVyeV9waG90b3MgKGlkLCB1cmwsIHByb2R1Y3RJZCkgVkFMVUVTICg/LCA/LCA/KScsXG4gICAgICAgICAgW3JhbmRvbVVVSUQoKSwgcHJvZHVjdERhdGEucGhvdG9VcmxzW2ldLCBpZF1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IGlkLCAuLi5wcm9kdWN0RGF0YSB9XG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG4vLyBHRVQgYWxsIHByb2R1Y3RzIChwdWJsaWMpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUHJvZHVjdHMoKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IFtyb3dzXSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUIFxuICAgICAgICBpZCwgbmFtZSwgY2F0ZWdvcnlJZCwgZGVzY3JpcHRpb24sIHNpemVzLCBcbiAgICAgICAgXFxgY29uZGl0aW9uXFxgLCBwcmljZSwgc3RvY2ssIHBob3RvVXJsLCB1c2VySWQsIGNyZWF0ZWRBdFxuICAgICAgIEZST00gcHJvZHVjdHMgXG4gICAgICAgT1JERVIgQlkgY3JlYXRlZEF0IERFU0NgXG4gICAgKVxuXG4gICAgY29uc3QgcHJvZHVjdHMgPSAocm93cyBhcyBhbnlbXSkubWFwKHJvdyA9PiAoe1xuICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgIG5hbWU6IHJvdy5uYW1lLFxuICAgICAgY2F0ZWdvcnlJZDogcm93LmNhdGVnb3J5SWQsXG4gICAgICBkZXNjcmlwdGlvbjogcm93LmRlc2NyaXB0aW9uLFxuICAgICAgY29uZGl0aW9uOiByb3cuY29uZGl0aW9uLFxuICAgICAgcHJpY2U6IHJvdy5wcmljZSxcbiAgICAgIHN0b2NrOiByb3cuc3RvY2sgPz8gMCxcbiAgICAgIHNpemVzOiB0eXBlb2Ygcm93LnNpemVzID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2Uocm93LnNpemVzKSA6IChyb3cuc2l6ZXMgfHwgW10pLFxuICAgICAgcGhvdG9Vcmw6IHJvdy5waG90b1VybCxcbiAgICAgIHVzZXJJZDogcm93LnVzZXJJZCxcbiAgICAgIGNyZWF0ZWRBdDogcm93LmNyZWF0ZWRBdCxcbiAgICAgIHJhdGluZzogNC41LFxuICAgICAgc29sZDogMCxcbiAgICB9KSlcblxuICAgIC8vIEZldGNoIGdhbGxlcnkgcGhvdG9zIGZvciBhbGwgcHJvZHVjdHMgaW4gb25lIHF1ZXJ5XG4gICAgY29uc3QgcHJvZHVjdElkcyA9IHByb2R1Y3RzLm1hcChwID0+IHAuaWQpXG4gICAgaWYgKHByb2R1Y3RJZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW11cblxuICAgIC8vIFZhbGlkYXRlIGFsbCBwcm9kdWN0SWRzIGFyZSBVVUlEcyB0byBwcmV2ZW50IFNRTCBpbmplY3Rpb25cbiAgICBjb25zdCB2YWxpZFByb2R1Y3RJZHMgPSBwcm9kdWN0SWRzLmZpbHRlcihpZCA9PlxuICAgICAgdHlwZW9mIGlkID09PSAnc3RyaW5nJyAmJiAvXlthLWYwLTktXXszNn0kL2kudGVzdChpZClcbiAgICApXG5cbiAgICBsZXQgcGhvdG9zQnlQcm9kdWN0OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fVxuICAgIGlmICh2YWxpZFByb2R1Y3RJZHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gdmFsaWRQcm9kdWN0SWRzLm1hcCgoKSA9PiAnPycpLmpvaW4oJywnKVxuICAgICAgY29uc3QgW3Bob3Rvc1Jvd3NdOiBhbnkgPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgICBgU0VMRUNUIHByb2R1Y3RJZCwgdXJsIEZST00gZ2FsbGVyeV9waG90b3MgV0hFUkUgcHJvZHVjdElkIElOICgke3BsYWNlaG9sZGVyc30pYCxcbiAgICAgICAgdmFsaWRQcm9kdWN0SWRzXG4gICAgICApXG5cbiAgICAgIGZvciAoY29uc3QgcHIgb2YgcGhvdG9zUm93cykge1xuICAgICAgICBwaG90b3NCeVByb2R1Y3RbcHIucHJvZHVjdElkXSA9IHBob3Rvc0J5UHJvZHVjdFtwci5wcm9kdWN0SWRdIHx8IFtdXG4gICAgICAgIHBob3Rvc0J5UHJvZHVjdFtwci5wcm9kdWN0SWRdLnB1c2gocHIudXJsKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEJ1aWxkIGZ1bGwgcGhvdG9VcmxzIGFycmF5OiBwcmltYXJ5IHBob3RvVXJsIGZpcnN0IGlmIGV4aXN0cywgdGhlbiBnYWxsZXJ5IHBob3Rvc1xuICAgIHJldHVybiBwcm9kdWN0cy5tYXAocCA9PiB7XG4gICAgICBjb25zdCBnYWxsZXJ5ID0gcGhvdG9zQnlQcm9kdWN0W3AuaWRdIHx8IFtdXG4gICAgICBjb25zdCBwaG90b1VybHMgPSBbXVxuICAgICAgaWYgKHAucGhvdG9VcmwpIHBob3RvVXJscy5wdXNoKHAucGhvdG9VcmwpXG4gICAgICBwaG90b1VybHMucHVzaCguLi5nYWxsZXJ5KVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHAuaWQsXG4gICAgICAgIG5hbWU6IHAubmFtZSxcbiAgICAgICAgY2F0ZWdvcnlJZDogcC5jYXRlZ29yeUlkLFxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbixcbiAgICAgICAgY29uZGl0aW9uOiBwLmNvbmRpdGlvbixcbiAgICAgICAgcHJpY2U6IHAucHJpY2UsXG4gICAgICAgIHN0b2NrOiBwLnN0b2NrID8/IDAsXG4gICAgICAgIHNpemVzOiBwLnNpemVzLFxuICAgICAgICBwaG90b1VybHMsXG4gICAgICAgIHVzZXJJZDogcC51c2VySWQsXG4gICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXG4gICAgICAgIHJhdGluZzogcC5yYXRpbmcsXG4gICAgICAgIHNvbGQ6IHAuc29sZCxcbiAgICAgIH1cbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgYWxsIHByb2R1Y3RzOicsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuLy8gR0VUIHByb2R1Y3RzIGJ5IHVzZXIgSURcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0J5VXNlcklkKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IFtyb3dzXSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUIFxuICAgICAgICBpZCwgbmFtZSwgY2F0ZWdvcnlJZCwgZGVzY3JpcHRpb24sIHNpemVzLCBcbiAgICAgICAgXFxgY29uZGl0aW9uXFxgLCBwcmljZSwgc3RvY2ssIHBob3RvVXJsLCB1c2VySWQsIGNyZWF0ZWRBdFxuICAgICAgIEZST00gcHJvZHVjdHMgXG4gICAgICAgV0hFUkUgdXNlcklkID0gP1xuICAgICAgIE9SREVSIEJZIGNyZWF0ZWRBdCBERVNDYCxcbiAgICAgIFt1c2VySWRdXG4gICAgKVxuICAgIGNvbnN0IHByb2R1Y3RzID0gKHJvd3MgYXMgYW55W10pLm1hcChyb3cgPT4gKHtcbiAgICAgIC4uLnJvdyxcbiAgICAgIHNpemVzOiB0eXBlb2Ygcm93LnNpemVzID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2Uocm93LnNpemVzKSA6IHJvdy5zaXplcyxcbiAgICAgIHN0b2NrOiByb3cuc3RvY2sgPz8gMCxcbiAgICAgIHBob3RvVXJsOiByb3cucGhvdG9VcmwsXG4gICAgfSkpXG5cbiAgICBjb25zdCBwcm9kdWN0SWRzID0gcHJvZHVjdHMubWFwKHAgPT4gcC5pZClcbiAgICBpZiAocHJvZHVjdElkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBwcm9kdWN0cy5tYXAocCA9PiAoeyAuLi5wLCBwaG90b1VybHM6IHAucGhvdG9VcmwgPyBbcC5waG90b1VybF0gOiBbXSB9KSlcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBhbGwgcHJvZHVjdElkcyBhcmUgVVVJRHMgdG8gcHJldmVudCBTUUwgaW5qZWN0aW9uXG4gICAgY29uc3QgdmFsaWRQcm9kdWN0SWRzID0gcHJvZHVjdElkcy5maWx0ZXIoaWQgPT5cbiAgICAgIHR5cGVvZiBpZCA9PT0gJ3N0cmluZycgJiYgL15bYS1mMC05LV17MzZ9JC9pLnRlc3QoaWQpXG4gICAgKVxuXG4gICAgbGV0IHBob3Rvc0J5UHJvZHVjdDogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge31cbiAgICBpZiAodmFsaWRQcm9kdWN0SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHBsYWNlaG9sZGVycyA9IHZhbGlkUHJvZHVjdElkcy5tYXAoKCkgPT4gJz8nKS5qb2luKCcsJylcbiAgICAgIGNvbnN0IFtwaG90b3NSb3dzXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICAgYFNFTEVDVCBwcm9kdWN0SWQsIHVybCBGUk9NIGdhbGxlcnlfcGhvdG9zIFdIRVJFIHByb2R1Y3RJZCBJTiAoJHtwbGFjZWhvbGRlcnN9KWAsXG4gICAgICAgIHZhbGlkUHJvZHVjdElkc1xuICAgICAgKVxuXG4gICAgICBmb3IgKGNvbnN0IHByIG9mIHBob3Rvc1Jvd3MpIHtcbiAgICAgICAgcGhvdG9zQnlQcm9kdWN0W3ByLnByb2R1Y3RJZF0gPSBwaG90b3NCeVByb2R1Y3RbcHIucHJvZHVjdElkXSB8fCBbXVxuICAgICAgICBwaG90b3NCeVByb2R1Y3RbcHIucHJvZHVjdElkXS5wdXNoKHByLnVybClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcHJvZHVjdHMubWFwKHAgPT4ge1xuICAgICAgY29uc3QgZ2FsbGVyeSA9IHBob3Rvc0J5UHJvZHVjdFtwLmlkXSB8fCBbXVxuICAgICAgY29uc3QgcGhvdG9VcmxzID0gW11cbiAgICAgIGlmIChwLnBob3RvVXJsKSBwaG90b1VybHMucHVzaChwLnBob3RvVXJsKVxuICAgICAgcGhvdG9VcmxzLnB1c2goLi4uZ2FsbGVyeSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnAsXG4gICAgICAgIHBob3RvVXJscyxcbiAgICAgIH1cbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgcHJvZHVjdHMgYnkgdXNlcjonLCBlcnJvcilcbiAgICByZXR1cm4gW11cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0QnlJZChpZDogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IFtyb3dzXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHByb2R1Y3RzIFdIRVJFIGlkID0gPycsXG4gICAgICBbaWRdXG4gICAgKVxuICAgIGlmIChyb3dzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGxcblxuICAgIGNvbnN0IHJvdyA9IHJvd3NbMF1cbiAgICBjb25zdCBzaXplcyA9IHR5cGVvZiByb3cuc2l6ZXMgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShyb3cuc2l6ZXMpIDogKHJvdy5zaXplcyB8fCBbXSlcbiAgICAvLyBGZXRjaCBnYWxsZXJ5IHBob3RvcyBmb3IgdGhpcyBwcm9kdWN0XG4gICAgY29uc3QgW3Bob3RvUm93c106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAnU0VMRUNUIHVybCBGUk9NIGdhbGxlcnlfcGhvdG9zIFdIRVJFIHByb2R1Y3RJZCA9ID8gT1JERVIgQlkgY3JlYXRlZEF0IEFTQycsXG4gICAgICBbaWRdXG4gICAgKVxuICAgIGNvbnN0IGdhbGxlcnlVcmxzID0gKHBob3RvUm93cyB8fCBbXSkubWFwKChyOiBhbnkpID0+IHIudXJsKVxuICAgIGNvbnN0IHBob3RvVXJscyA9IFtdXG4gICAgaWYgKHJvdy5waG90b1VybCkgcGhvdG9VcmxzLnB1c2gocm93LnBob3RvVXJsKVxuICAgIHBob3RvVXJscy5wdXNoKC4uLmdhbGxlcnlVcmxzKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnJvdyxcbiAgICAgIHNpemVzLFxuICAgICAgcGhvdG9VcmxzLFxuICAgICAgc3RvY2s6IHJvdy5zdG9jayA/PyAwLFxuICAgICAgcmF0aW5nOiA0LjUsXG4gICAgICBzb2xkOiAwLFxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHByb2R1Y3QgYnkgSUQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0KGlkOiBzdHJpbmcsIGRhdGE6IGFueSkge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICAvLyBQcmVwYXJlIHVwZGF0ZSBmaWVsZHNcbiAgICBjb25zdCB1cGRhdGVGaWVsZHM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW11cblxuICAgIC8vIEhhbmRsZSBlYWNoIGZpZWxkXG4gICAgaWYgKGRhdGEubmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVGaWVsZHMucHVzaCgnbmFtZSA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5uYW1lKVxuICAgIH1cbiAgICBpZiAoZGF0YS5jYXRlZ29yeUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdjYXRlZ29yeUlkID0gPycpXG4gICAgICB2YWx1ZXMucHVzaChkYXRhLmNhdGVnb3J5SWQpXG4gICAgfVxuICAgIGlmIChkYXRhLmRlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdkZXNjcmlwdGlvbiA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5kZXNjcmlwdGlvbilcbiAgICB9XG4gICAgaWYgKGRhdGEuY29uZGl0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdgY29uZGl0aW9uYCA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5jb25kaXRpb24pXG4gICAgfVxuICAgIGlmIChkYXRhLnByaWNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdwcmljZSA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5wcmljZSlcbiAgICB9XG4gICAgaWYgKGRhdGEuc3RvY2sgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRmllbGRzLnB1c2goJ3N0b2NrID0gPycpXG4gICAgICB2YWx1ZXMucHVzaChkYXRhLnN0b2NrKVxuICAgIH1cbiAgICBpZiAoZGF0YS5zaXplcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVGaWVsZHMucHVzaCgnc2l6ZXMgPSA/JylcbiAgICAgIHZhbHVlcy5wdXNoKEpTT04uc3RyaW5naWZ5KGRhdGEuc2l6ZXMpKVxuICAgIH1cbiAgICAvLyBJZiBwaG90b1VybHMgcHJvdmlkZWQsIHNldCBwcmltYXJ5IHBob3RvIChmaXJzdCkgaW4gcHJvZHVjdHMucGhvdG9VcmxcbiAgICBpZiAoZGF0YS5waG90b1VybHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgcHJpbWFyeSA9IGRhdGEucGhvdG9VcmxzLmxlbmd0aCA+IDAgPyBkYXRhLnBob3RvVXJsc1swXSA6IG51bGxcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdwaG90b1VybCA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2gocHJpbWFyeSlcbiAgICB9XG5cbiAgICAvLyBBbHdheXMgdXBkYXRlIHRpbWVzdGFtcFxuICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCd1cGRhdGVkQXQgPSBOT1coKScpXG5cbiAgICAvLyBBZGQgcHJvZHVjdCBpZCBhcyBsYXN0IHBhcmFtZXRlclxuICAgIHZhbHVlcy5wdXNoKGlkKVxuXG4gICAgaWYgKHVwZGF0ZUZpZWxkcy5sZW5ndGggPiAxKSB7IC8vIE1vcmUgdGhhbiBqdXN0IHVwZGF0ZWRBdFxuICAgICAgY29uc3QgcXVlcnkgPSBgVVBEQVRFIHByb2R1Y3RzIFNFVCAke3VwZGF0ZUZpZWxkcy5qb2luKCcsICcpfSBXSEVSRSBpZCA9ID9gXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KHF1ZXJ5LCB2YWx1ZXMpXG4gICAgfVxuXG4gICAgLy8gSWYgcGhvdG9VcmxzIHByb3ZpZGVkLCBzeW5jaHJvbml6ZSBnYWxsZXJ5X3Bob3RvczpcbiAgICBpZiAoZGF0YS5waG90b1VybHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIGdhbGxlcnkgcGhvdG9zIGZvciB0aGlzIHByb2R1Y3RcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoJ0RFTEVURSBGUk9NIGdhbGxlcnlfcGhvdG9zIFdIRVJFIHByb2R1Y3RJZCA9ID8nLCBbaWRdKVxuICAgICAgLy8gSW5zZXJ0IHJlbWFpbmluZyBwaG90b3MgKGZyb20gaW5kZXggMS4uKVxuICAgICAgaWYgKGRhdGEucGhvdG9VcmxzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgY29uc3QgaW5zZXJ0czogYW55W10gPSBbXVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRhdGEucGhvdG9VcmxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaW5zZXJ0cy5wdXNoKFtyYW5kb21VVUlEKCksIGRhdGEucGhvdG9VcmxzW2ldLCBpZF0pXG4gICAgICAgIH1cbiAgICAgICAgLy8gQnVsayBpbnNlcnRcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJzID0gaW5zZXJ0cy5tYXAoKCkgPT4gJyg/LCA/LCA/KScpLmpvaW4oJywgJylcbiAgICAgICAgY29uc3QgZmxhdFZhbHVlcyA9IGluc2VydHMuZmxhdCgpXG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAgICAgYElOU0VSVCBJTlRPIGdhbGxlcnlfcGhvdG9zIChpZCwgdXJsLCBwcm9kdWN0SWQpIFZBTFVFUyAke3BsYWNlaG9sZGVyc31gLFxuICAgICAgICAgIGZsYXRWYWx1ZXNcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IGlkLCAuLi5kYXRhIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdVcGRhdGUgcHJvZHVjdCBlcnJvcjonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3QoaWQ6IHN0cmluZykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KCdERUxFVEUgRlJPTSBwcm9kdWN0cyBXSEVSRSBpZCA9ID8nLCBbaWRdKVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhdGVnb3JpZXMoKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IFtyb3dzXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnU0VMRUNUICogRlJPTSBjYXRlZ29yaWVzJylcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShyb3dzKSA/IHJvd3MgOiBbXVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tEQl0gZ2V0Q2F0ZWdvcmllcyBlcnJvcjonLCBlcnJvcilcbiAgICAvLyBSZXR1cm4gZW1wdHkgYXJyYXkgb24gZXJyb3IgZm9yIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgcmV0dXJuIFtdXG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlclBhc3N3b3JkQnlFbWFpbChlbWFpbDogc3RyaW5nLCBoYXNoZWRQYXNzd29yZDogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAnVVBEQVRFIHVzZXJzIFNFVCBwYXNzd29yZCA9ID8sIHVwZGF0ZWRBdCA9IE5PVygpIFdIRVJFIGVtYWlsID0gPycsXG4gICAgICBbaGFzaGVkUGFzc3dvcmQsIGVtYWlsXVxuICAgIClcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbi8vIENhcnQgZnVuY3Rpb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkVG9DYXJ0KHVzZXJJZDogc3RyaW5nLCBwcm9kdWN0SWQ6IHN0cmluZywgcXVhbnRpdHk6IG51bWJlciA9IDEpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgaWQgPSByYW5kb21VVUlEKClcbiAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgJ0lOU0VSVCBJTlRPIGNhcnRzIChpZCwgdXNlcklkLCBwcm9kdWN0SWQsIHF1YW50aXR5KSBWQUxVRVMgKD8sID8sID8sID8pIE9OIERVUExJQ0FURSBLRVkgVVBEQVRFIHF1YW50aXR5ID0gcXVhbnRpdHkgKyA/JyxcbiAgICAgIFtpZCwgdXNlcklkLCBwcm9kdWN0SWQsIHF1YW50aXR5LCBxdWFudGl0eV1cbiAgICApXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FydCh1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCBbY2FydEl0ZW1zXTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgIGBTRUxFQ1QgXG4gICAgICAgIGMuaWQsIGMucXVhbnRpdHksIFxuICAgICAgICBwLmlkIGFzIHByb2R1Y3RJZCwgcC5uYW1lLCBwLnByaWNlLCBwLnBob3RvVXJsLCBcbiAgICAgICAgcC5jYXRlZ29yeUlkLCBwLmNvbmRpdGlvblxuICAgICAgRlJPTSBjYXJ0cyBjXG4gICAgICBKT0lOIHByb2R1Y3RzIHAgT04gYy5wcm9kdWN0SWQgPSBwLmlkXG4gICAgICBXSEVSRSBjLnVzZXJJZCA9ID9cbiAgICAgIE9SREVSIEJZIGMuY3JlYXRlZEF0IERFU0NgLFxuICAgICAgW3VzZXJJZF1cbiAgICApXG5cbiAgICByZXR1cm4gY2FydEl0ZW1zLm1hcCgoaXRlbTogYW55KSA9PiAoe1xuICAgICAgY2FydElkOiBpdGVtLmlkLFxuICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICBwcm9kdWN0OiB7XG4gICAgICAgIGlkOiBpdGVtLnByb2R1Y3RJZCxcbiAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxuICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgcGhvdG9Vcmw6IGl0ZW0ucGhvdG9VcmwsXG4gICAgICAgIGNhdGVnb3J5SWQ6IGl0ZW0uY2F0ZWdvcnlJZCxcbiAgICAgICAgY29uZGl0aW9uOiBpdGVtLmNvbmRpdGlvbixcbiAgICAgIH0sXG4gICAgfSkpXG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FydFF1YW50aXR5KGNhcnRJZDogc3RyaW5nLCBxdWFudGl0eTogbnVtYmVyKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGlmIChxdWFudGl0eSA8PSAwKSB7XG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KCdERUxFVEUgRlJPTSBjYXJ0cyBXSEVSRSBpZCA9ID8nLCBbY2FydElkXSlcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnVVBEQVRFIGNhcnRzIFNFVCBxdWFudGl0eSA9ID8gV0hFUkUgaWQgPSA/JywgW3F1YW50aXR5LCBjYXJ0SWRdKVxuICAgIH1cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVGcm9tQ2FydChjYXJ0SWQ6IHN0cmluZykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KCdERUxFVEUgRlJPTSBjYXJ0cyBXSEVSRSBpZCA9ID8nLCBbY2FydElkXSlcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhckNhcnQodXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnREVMRVRFIEZST00gY2FydHMgV0hFUkUgdXNlcklkID0gPycsIFt1c2VySWRdKVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuLy8gT3JkZXIgZnVuY3Rpb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlT3JkZXIodXNlcklkOiBzdHJpbmcsIGNhcnRJdGVtczogYW55W10sIHNoaXBwaW5nRGF0YTogYW55KSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IG9yZGVySWQgPSByYW5kb21VVUlEKClcbiAgICBjb25zdCB0b3RhbEFtb3VudCA9IGNhcnRJdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKGl0ZW0ucHJvZHVjdC5wcmljZSAqIGl0ZW0ucXVhbnRpdHkpLCAwKVxuXG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgIGBJTlNFUlQgSU5UTyBvcmRlcnMgXG4gICAgICAgIChpZCwgdXNlcklkLCB0b3RhbEFtb3VudCwgc2hpcHBpbmdBZGRyZXNzLCBzaGlwcGluZ0NpdHksIHNoaXBwaW5nUG9zdGFsLCBcbiAgICAgICAgIHNoaXBwaW5nUGhvbmUsIHBheW1lbnRTdGF0dXMsIG9yZGVyU3RhdHVzKSBcbiAgICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8sID8pYCxcbiAgICAgIFtcbiAgICAgICAgb3JkZXJJZCxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB0b3RhbEFtb3VudCxcbiAgICAgICAgc2hpcHBpbmdEYXRhLmFkZHJlc3MsXG4gICAgICAgIHNoaXBwaW5nRGF0YS5jaXR5LFxuICAgICAgICBzaGlwcGluZ0RhdGEucG9zdGFsLFxuICAgICAgICBzaGlwcGluZ0RhdGEucGhvbmUsXG4gICAgICAgICdQRU5ESU5HJyxcbiAgICAgICAgJ1BFTkRJTkcnLFxuICAgICAgXVxuICAgIClcblxuICAgIC8vIEluc2VydCBvcmRlciBpdGVtc1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBjYXJ0SXRlbXMpIHtcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAgIGBJTlNFUlQgSU5UTyBvcmRlcl9pdGVtcyAoaWQsIG9yZGVySWQsIHByb2R1Y3RJZCwgcXVhbnRpdHksIHByaWNlKVxuICAgICAgICAgVkFMVUVTICg/LCA/LCA/LCA/LCA/KWAsXG4gICAgICAgIFtcbiAgICAgICAgICByYW5kb21VVUlEKCksXG4gICAgICAgICAgb3JkZXJJZCxcbiAgICAgICAgICBpdGVtLnByb2R1Y3QuaWQsXG4gICAgICAgICAgaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICBpdGVtLnByb2R1Y3QucHJpY2UsXG4gICAgICAgIF1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBDbGVhciBjYXJ0XG4gICAgYXdhaXQgY2xlYXJDYXJ0KHVzZXJJZClcblxuICAgIHJldHVybiB7IG9yZGVySWQsIHRvdGFsQW1vdW50IH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmRlcnModXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgW29yZGVyc106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUICogRlJPTSBvcmRlcnMgV0hFUkUgdXNlcklkID0gPyBPUkRFUiBCWSBjcmVhdGVkQXQgREVTQ2AsXG4gICAgICBbdXNlcklkXVxuICAgIClcblxuICAgIGNvbnN0IG9yZGVyc1dpdGhJdGVtcyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgb3JkZXJzLm1hcChhc3luYyAob3JkZXI6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBbaXRlbXNdOiBhbnkgPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgICAgIGBTRUxFQ1Qgb2kuKiwgcC5uYW1lLCBwLnBob3RvVXJsIFxuICAgICAgICAgICBGUk9NIG9yZGVyX2l0ZW1zIG9pXG4gICAgICAgICAgIEpPSU4gcHJvZHVjdHMgcCBPTiBvaS5wcm9kdWN0SWQgPSBwLmlkXG4gICAgICAgICAgIFdIRVJFIG9pLm9yZGVySWQgPSA/YCxcbiAgICAgICAgICBbb3JkZXIuaWRdXG4gICAgICAgIClcbiAgICAgICAgcmV0dXJuIHsgLi4ub3JkZXIsIGl0ZW1zIH1cbiAgICAgIH0pXG4gICAgKVxuXG4gICAgcmV0dXJuIG9yZGVyc1dpdGhJdGVtc1xuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZGVyQnlJZChvcmRlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgW29yZGVyc106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUIG8uKiwgdS5pZCBhcyB1c2VySWQsIHUubmFtZSBhcyB1c2VyTmFtZSwgdS5lbWFpbCBhcyB1c2VyRW1haWxcbiAgICAgICBGUk9NIG9yZGVycyBvXG4gICAgICAgTEVGVCBKT0lOIHVzZXJzIHUgT04gby51c2VySWQgPSB1LmlkXG4gICAgICAgV0hFUkUgby5pZCA9ID9gLFxuICAgICAgW29yZGVySWRdXG4gICAgKVxuXG4gICAgaWYgKG9yZGVycy5sZW5ndGggPT09IDApIHJldHVybiBudWxsXG5cbiAgICBjb25zdCBvcmRlciA9IG9yZGVyc1swXVxuICAgIGNvbnN0IFtpdGVtc106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUIG9pLiosIHAuaWQgYXMgcHJvZHVjdElkLCBwLm5hbWUsIHAucHJpY2UsIHAucGhvdG9VcmwgXG4gICAgICAgRlJPTSBvcmRlcl9pdGVtcyBvaVxuICAgICAgIEpPSU4gcHJvZHVjdHMgcCBPTiBvaS5wcm9kdWN0SWQgPSBwLmlkXG4gICAgICAgV0hFUkUgb2kub3JkZXJJZCA9ID9gLFxuICAgICAgW29yZGVySWRdXG4gICAgKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm9yZGVyLFxuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogb3JkZXIudXNlcklkLFxuICAgICAgICBuYW1lOiBvcmRlci51c2VyTmFtZSxcbiAgICAgICAgZW1haWw6IG9yZGVyLnVzZXJFbWFpbFxuICAgICAgfSxcbiAgICAgIGl0ZW1zOiBpdGVtcy5tYXAoKGl0ZW06IGFueSkgPT4gKHtcbiAgICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgcHJvZHVjdDoge1xuICAgICAgICAgIGlkOiBpdGVtLnByb2R1Y3RJZCxcbiAgICAgICAgICBuYW1lOiBpdGVtLm5hbWVcbiAgICAgICAgfVxuICAgICAgfSkpXG4gICAgfVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU9yZGVyUGF5bWVudChvcmRlcklkOiBzdHJpbmcsIHBheW1lbnRJZDogc3RyaW5nLCBwYXltZW50VXJsOiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgICdVUERBVEUgb3JkZXJzIFNFVCBwYXltZW50SWQgPSA/LCBwYXltZW50VXJsID0gPywgdXBkYXRlZEF0ID0gTk9XKCkgV0hFUkUgaWQgPSA/JyxcbiAgICAgIFtwYXltZW50SWQsIHBheW1lbnRVcmwsIG9yZGVySWRdXG4gICAgKVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU9yZGVyU3RhdHVzKG9yZGVySWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcsIHBheW1lbnRTdGF0dXM/OiBzdHJpbmcpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgdXBkYXRlczogc3RyaW5nW10gPSBbJ29yZGVyU3RhdHVzID0gPyddXG4gICAgY29uc3QgdmFsdWVzOiBhbnlbXSA9IFtzdGF0dXNdXG5cbiAgICBpZiAocGF5bWVudFN0YXR1cykge1xuICAgICAgdXBkYXRlcy5wdXNoKCdwYXltZW50U3RhdHVzID0gPycpXG4gICAgICB2YWx1ZXMucHVzaChwYXltZW50U3RhdHVzKVxuICAgIH1cblxuICAgIHZhbHVlcy5wdXNoKG9yZGVySWQpXG5cbiAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgYFVQREFURSBvcmRlcnMgU0VUICR7dXBkYXRlcy5qb2luKCcsICcpfSwgdXBkYXRlZEF0ID0gTk9XKCkgV0hFUkUgaWQgPSA/YCxcbiAgICAgIHZhbHVlc1xuICAgIClcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxPcmRlcnMocGFnZTogbnVtYmVyID0gMSwgbGltaXQ6IG51bWJlciA9IDEwLCBzdGF0dXM6IHN0cmluZyA9ICdBTEwnKSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IG9mZnNldCA9IChwYWdlIC0gMSkgKiBsaW1pdFxuICAgIGxldCB3aGVyZUNsYXVzZSA9ICcnXG4gICAgY29uc3QgcGFyYW1zOiBhbnlbXSA9IFtdXG5cbiAgICBpZiAoc3RhdHVzICE9PSAnQUxMJykge1xuICAgICAgd2hlcmVDbGF1c2UgPSAnV0hFUkUgby5vcmRlclN0YXR1cyA9ID8nXG4gICAgICBwYXJhbXMucHVzaChzdGF0dXMpXG4gICAgfVxuXG4gICAgLy8gR2V0IHRvdGFsIGNvdW50XG4gICAgY29uc3QgW2NvdW50UmVzdWx0XTogYW55ID0gYXdhaXQgY29ubmVjdGlvbi5xdWVyeShcbiAgICAgIGBTRUxFQ1QgQ09VTlQoKikgYXMgdG90YWwgRlJPTSBvcmRlcnMgbyAke3doZXJlQ2xhdXNlfWAsXG4gICAgICBwYXJhbXNcbiAgICApXG4gICAgY29uc3QgdG90YWxPcmRlcnMgPSBjb3VudFJlc3VsdFswXT8udG90YWwgfHwgMFxuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWxPcmRlcnMgLyBsaW1pdClcblxuICAgIC8vIEdldCBwYWdpbmF0ZWQgb3JkZXJzIHdpdGggdXNlciBpbmZvXG4gICAgY29uc3QgW29yZGVyc106IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICBgU0VMRUNUIG8uKiwgdS5uYW1lIGFzIHVzZXJfbmFtZSwgdS5lbWFpbCBhcyB1c2VyX2VtYWlsXG4gICAgICAgRlJPTSBvcmRlcnMgb1xuICAgICAgIExFRlQgSk9JTiB1c2VycyB1IE9OIG8udXNlcklkID0gdS5pZFxuICAgICAgICR7d2hlcmVDbGF1c2V9XG4gICAgICAgT1JERVIgQlkgby5jcmVhdGVkQXQgREVTQ1xuICAgICAgIExJTUlUID8gT0ZGU0VUID9gLFxuICAgICAgWy4uLnBhcmFtcywgbGltaXQsIG9mZnNldF1cbiAgICApXG5cbiAgICAvLyBGb3JtYXQgcmVzcG9uc2VcbiAgICBjb25zdCBmb3JtYXR0ZWRPcmRlcnMgPSBvcmRlcnMubWFwKChvcmRlcjogYW55KSA9PiAoe1xuICAgICAgaWQ6IG9yZGVyLmlkLFxuICAgICAgdG90YWxBbW91bnQ6IG9yZGVyLnRvdGFsQW1vdW50LFxuICAgICAgb3JkZXJTdGF0dXM6IG9yZGVyLm9yZGVyU3RhdHVzLFxuICAgICAgcGF5bWVudFN0YXR1czogb3JkZXIucGF5bWVudFN0YXR1cyxcbiAgICAgIHNoaXBwaW5nQ2l0eTogb3JkZXIuc2hpcHBpbmdDaXR5LFxuICAgICAgdXNlcjoge1xuICAgICAgICBuYW1lOiBvcmRlci51c2VyX25hbWUsXG4gICAgICAgIGVtYWlsOiBvcmRlci51c2VyX2VtYWlsXG4gICAgICB9LFxuICAgICAgY3JlYXRlZEF0OiBvcmRlci5jcmVhdGVkQXQsXG4gICAgICBpdGVtczogW10gLy8gV2lsbCBiZSBwb3B1bGF0ZWQgaWYgbmVlZGVkXG4gICAgfSkpXG5cbiAgICByZXR1cm4ge1xuICAgICAgb3JkZXJzOiBmb3JtYXR0ZWRPcmRlcnMsXG4gICAgICB0b3RhbFBhZ2VzLFxuICAgICAgY3VycmVudFBhZ2U6IHBhZ2UsXG4gICAgICB0b3RhbE9yZGVyc1xuICAgIH1cbiAgfSBmaW5hbGx5IHtcbiAgICBjb25uZWN0aW9uLnJlbGVhc2UoKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVPcmRlckRldGFpbHMoaWQ6IHN0cmluZywgZGF0YTogYW55KSB7XG4gIGNvbnN0IGNvbm5lY3Rpb24gPSBhd2FpdCBwb29sLmdldENvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHVwZGF0ZUZpZWxkczogc3RyaW5nW10gPSBbXVxuICAgIGNvbnN0IHZhbHVlczogYW55W10gPSBbXVxuXG4gICAgaWYgKGRhdGEub3JkZXJTdGF0dXMpIHtcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdvcmRlclN0YXR1cyA9ID8nKVxuICAgICAgdmFsdWVzLnB1c2goZGF0YS5vcmRlclN0YXR1cylcbiAgICB9XG4gICAgaWYgKGRhdGEucGF5bWVudFN0YXR1cykge1xuICAgICAgdXBkYXRlRmllbGRzLnB1c2goJ3BheW1lbnRTdGF0dXMgPSA/JylcbiAgICAgIHZhbHVlcy5wdXNoKGRhdGEucGF5bWVudFN0YXR1cylcbiAgICB9XG4gICAgaWYgKGRhdGEubm90ZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlRmllbGRzLnB1c2goJ25vdGVzID0gPycpXG4gICAgICB2YWx1ZXMucHVzaChkYXRhLm5vdGVzKVxuICAgIH1cbiAgICBpZiAoZGF0YS5wcm9jZXNzZWRCeSkge1xuICAgICAgdXBkYXRlRmllbGRzLnB1c2goJ3Byb2Nlc3NlZEJ5ID0gPycpXG4gICAgICB2YWx1ZXMucHVzaChkYXRhLnByb2Nlc3NlZEJ5KVxuICAgICAgdXBkYXRlRmllbGRzLnB1c2goJ3Byb2Nlc3NlZEF0ID0gTk9XKCknKVxuICAgIH1cblxuICAgIC8vIEFsd2F5cyB1cGRhdGUgdGltZXN0YW1wXG4gICAgdXBkYXRlRmllbGRzLnB1c2goJ3VwZGF0ZWRBdCA9IE5PVygpJylcblxuICAgIHZhbHVlcy5wdXNoKGlkKVxuXG4gICAgaWYgKHVwZGF0ZUZpZWxkcy5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zdCBxdWVyeSA9IGBVUERBVEUgb3JkZXJzIFNFVCAke3VwZGF0ZUZpZWxkcy5qb2luKCcsICcpfSBXSEVSRSBpZCA9ID9gXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KHF1ZXJ5LCB2YWx1ZXMpXG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gIH0gZmluYWxseSB7XG4gICAgY29ubmVjdGlvbi5yZWxlYXNlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlT3JkZXIoaWQ6IHN0cmluZykge1xuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICAvLyBEZWxldGUgb3JkZXIgaXRlbXMgZmlyc3QgKGZvcmVpZ24ga2V5IGNvbnN0cmFpbnQpXG4gICAgYXdhaXQgY29ubmVjdGlvbi5xdWVyeSgnREVMRVRFIEZST00gb3JkZXJfaXRlbXMgV0hFUkUgb3JkZXJJZCA9ID8nLCBbaWRdKVxuXG4gICAgLy8gRGVsZXRlIG9yZGVyXG4gICAgY29uc3QgW3Jlc3VsdF06IGFueSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoJ0RFTEVURSBGUk9NIG9yZGVycyBXSEVSRSBpZCA9ID8nLCBbaWRdKVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogcmVzdWx0LmFmZmVjdGVkUm93cyA+IDAgfVxuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJteXNxbCIsInJhbmRvbVVVSUQiLCJiY3J5cHQiLCJwb29sQ29uZmlnIiwid2FpdEZvckNvbm5lY3Rpb25zIiwiY29ubmVjdGlvbkxpbWl0IiwicXVldWVMaW1pdCIsImVuYWJsZUtlZXBBbGl2ZSIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJzc2wiLCJtaW5WZXJzaW9uIiwicmVqZWN0VW5hdXRob3JpemVkIiwidXJsU3RyIiwidXJsIiwiVVJMIiwiaG9zdCIsImhvc3RuYW1lIiwidXNlciIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJkYXRhYmFzZSIsInBhdGhuYW1lIiwicmVwbGFjZSIsInBvcnQiLCJwYXJzZUludCIsInBhcnNlRXJyb3IiLCJub1Byb3RvIiwibGFzdEF0IiwibGFzdEluZGV4T2YiLCJjcmVkcyIsInN1YnN0cmluZyIsImFkZHJlc3MiLCJmaXJzdENvbG9uIiwiaW5kZXhPZiIsInNsYXNoSWR4IiwiaG9zdFBvcnQiLCJzcGxpdCIsImNvbG9uSWR4IiwiZSIsImNvbnNvbGUiLCJlcnJvciIsIkRCX0hPU1QiLCJEQl9VU0VSIiwiREJfUEFTU1dPUkQiLCJEQl9OQU1FIiwiREJfUE9SVCIsInBvb2wiLCJjcmVhdGVQb29sIiwiaXNJbml0aWFsaXplZCIsImluaXRQcm9taXNlIiwiaW5pdGlhbGl6ZURhdGFiYXNlIiwiY29ubmVjdGlvbiIsImdldENvbm5lY3Rpb24iLCJxdWVyeSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIndhcm4iLCJyb3dzIiwiZXhpc3RpbmciLCJtYXAiLCJyIiwiQ09MVU1OX05BTUUiLCJlMiIsImNhdGVnb3JpZXMiLCJjb3VudCIsImxvZyIsInJlbGVhc2UiLCJjcmVhdGVVc2VyIiwibmFtZSIsImVtYWlsIiwicm9sZSIsImhhc2hlZFBhc3N3b3JkIiwic3RhcnRzV2l0aCIsImhhc2giLCJpZCIsImNvZGUiLCJFcnJvciIsImdldFVzZXJCeUVtYWlsIiwibGVuZ3RoIiwiZ2V0VXNlckJ5SWQiLCJnZXRBbGxVc2VycyIsInVwZGF0ZVVzZXIiLCJkYXRhIiwiZmllbGRzIiwiT2JqZWN0Iiwia2V5cyIsImtleSIsImpvaW4iLCJ2YWx1ZXMiLCJkZWxldGVVc2VyIiwic3VjY2VzcyIsImNyZWF0ZVByb2R1Y3QiLCJwcm9kdWN0RGF0YSIsImNhdGVnb3J5SWQiLCJkZXNjcmlwdGlvbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaXplcyIsImNvbmRpdGlvbiIsInByaWNlIiwic3RvY2siLCJwaG90b1VybHMiLCJ1c2VySWQiLCJpIiwiZ2V0QWxsUHJvZHVjdHMiLCJwcm9kdWN0cyIsInJvdyIsInBhcnNlIiwicGhvdG9VcmwiLCJjcmVhdGVkQXQiLCJyYXRpbmciLCJzb2xkIiwicHJvZHVjdElkcyIsInAiLCJ2YWxpZFByb2R1Y3RJZHMiLCJmaWx0ZXIiLCJ0ZXN0IiwicGhvdG9zQnlQcm9kdWN0IiwicGxhY2Vob2xkZXJzIiwicGhvdG9zUm93cyIsInByIiwicHJvZHVjdElkIiwicHVzaCIsImdhbGxlcnkiLCJnZXRQcm9kdWN0c0J5VXNlcklkIiwiZ2V0UHJvZHVjdEJ5SWQiLCJwaG90b1Jvd3MiLCJnYWxsZXJ5VXJscyIsInVwZGF0ZVByb2R1Y3QiLCJ1cGRhdGVGaWVsZHMiLCJ1bmRlZmluZWQiLCJwcmltYXJ5IiwiaW5zZXJ0cyIsImZsYXRWYWx1ZXMiLCJmbGF0IiwiZGVsZXRlUHJvZHVjdCIsImdldENhdGVnb3JpZXMiLCJBcnJheSIsImlzQXJyYXkiLCJ1cGRhdGVVc2VyUGFzc3dvcmRCeUVtYWlsIiwiYWRkVG9DYXJ0IiwicXVhbnRpdHkiLCJnZXRDYXJ0IiwiY2FydEl0ZW1zIiwiaXRlbSIsImNhcnRJZCIsInByb2R1Y3QiLCJ1cGRhdGVDYXJ0UXVhbnRpdHkiLCJyZW1vdmVGcm9tQ2FydCIsImNsZWFyQ2FydCIsImNyZWF0ZU9yZGVyIiwic2hpcHBpbmdEYXRhIiwib3JkZXJJZCIsInRvdGFsQW1vdW50IiwicmVkdWNlIiwic3VtIiwiY2l0eSIsInBvc3RhbCIsInBob25lIiwiZ2V0T3JkZXJzIiwib3JkZXJzIiwib3JkZXJzV2l0aEl0ZW1zIiwiUHJvbWlzZSIsImFsbCIsIm9yZGVyIiwiaXRlbXMiLCJnZXRPcmRlckJ5SWQiLCJ1c2VyTmFtZSIsInVzZXJFbWFpbCIsInVwZGF0ZU9yZGVyUGF5bWVudCIsInBheW1lbnRJZCIsInBheW1lbnRVcmwiLCJ1cGRhdGVPcmRlclN0YXR1cyIsInN0YXR1cyIsInBheW1lbnRTdGF0dXMiLCJ1cGRhdGVzIiwiZ2V0QWxsT3JkZXJzIiwicGFnZSIsImxpbWl0Iiwib2Zmc2V0Iiwid2hlcmVDbGF1c2UiLCJwYXJhbXMiLCJjb3VudFJlc3VsdCIsInRvdGFsT3JkZXJzIiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiLCJmb3JtYXR0ZWRPcmRlcnMiLCJvcmRlclN0YXR1cyIsInNoaXBwaW5nQ2l0eSIsInVzZXJfbmFtZSIsInVzZXJfZW1haWwiLCJjdXJyZW50UGFnZSIsInVwZGF0ZU9yZGVyRGV0YWlscyIsIm5vdGVzIiwicHJvY2Vzc2VkQnkiLCJkZWxldGVPcmRlciIsInJlc3VsdCIsImFmZmVjdGVkUm93cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ratelimit.ts":
/*!**************************!*\
  !*** ./lib/ratelimit.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loginRateLimiter: () => (/* binding */ loginRateLimiter),\n/* harmony export */   registerRateLimiter: () => (/* binding */ registerRateLimiter)\n/* harmony export */ });\n/**\r\n * Simple in-memory rate limiter for authentication endpoints\r\n * Tracks attempts per identifier (email/IP) with automatic cleanup\r\n */ class RateLimiter {\n    attempts = new Map();\n    maxAttempts;\n    windowMs;\n    constructor(maxAttempts = 5, windowMinutes = 15){\n        this.maxAttempts = maxAttempts;\n        this.windowMs = windowMinutes * 60 * 1000;\n        // Cleanup old entries every 5 minutes\n        setInterval(()=>this.cleanup(), 5 * 60 * 1000);\n    }\n    /**\r\n     * Check if identifier is rate limited\r\n     * @param identifier - Email or IP address\r\n     * @returns true if allowed, false if rate limited\r\n     */ check(identifier) {\n        const now = Date.now();\n        const entry = this.attempts.get(identifier);\n        if (!entry) {\n            // First attempt\n            this.attempts.set(identifier, {\n                count: 1,\n                firstAttempt: now,\n                resetAt: now + this.windowMs\n            });\n            return true;\n        }\n        // Check if window has expired\n        if (now > entry.resetAt) {\n            // Reset the window\n            this.attempts.set(identifier, {\n                count: 1,\n                firstAttempt: now,\n                resetAt: now + this.windowMs\n            });\n            return true;\n        }\n        // Within window - increment count\n        if (entry.count >= this.maxAttempts) {\n            return false // Rate limited\n            ;\n        }\n        entry.count++;\n        this.attempts.set(identifier, entry);\n        return true;\n    }\n    /**\r\n     * Reset attempts for an identifier (e.g., after successful login)\r\n     */ reset(identifier) {\n        this.attempts.delete(identifier);\n    }\n    /**\r\n     * Get remaining attempts for an identifier\r\n     */ getRemaining(identifier) {\n        const entry = this.attempts.get(identifier);\n        if (!entry) return this.maxAttempts;\n        const now = Date.now();\n        if (now > entry.resetAt) return this.maxAttempts;\n        return Math.max(0, this.maxAttempts - entry.count);\n    }\n    /**\r\n     * Get time until reset in seconds\r\n     */ getResetTime(identifier) {\n        const entry = this.attempts.get(identifier);\n        if (!entry) return 0;\n        const now = Date.now();\n        if (now > entry.resetAt) return 0;\n        return Math.ceil((entry.resetAt - now) / 1000);\n    }\n    /**\r\n     * Cleanup expired entries\r\n     */ cleanup() {\n        const now = Date.now();\n        for (const [key, entry] of this.attempts.entries()){\n            if (now > entry.resetAt) {\n                this.attempts.delete(key);\n            }\n        }\n    }\n}\n// Export singleton instances for different endpoints\nconst loginRateLimiter = new RateLimiter(5, 15) // 5 attempts per 15 minutes\n;\nconst registerRateLimiter = new RateLimiter(3, 60) // 3 registrations per hour\n;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW1CLElBQUkzQixZQUFZLEdBQUcsSUFBSSw0QkFBNEI7Q0FBN0I7QUFDL0MsTUFBTTRCLHNCQUFzQixJQUFJNUIsWUFBWSxHQUFHLElBQUksMkJBQTJCO0NBQTVCIiwic291cmNlcyI6WyJDOlxceGFtcHBcXGh0ZG9jc1xcZ3Jha3kgc3RvcmUgd2ViXFxsaWJcXHJhdGVsaW1pdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2ltcGxlIGluLW1lbW9yeSByYXRlIGxpbWl0ZXIgZm9yIGF1dGhlbnRpY2F0aW9uIGVuZHBvaW50c1xyXG4gKiBUcmFja3MgYXR0ZW1wdHMgcGVyIGlkZW50aWZpZXIgKGVtYWlsL0lQKSB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwXHJcbiAqL1xyXG5cclxuaW50ZXJmYWNlIFJhdGVMaW1pdEVudHJ5IHtcclxuICAgIGNvdW50OiBudW1iZXJcclxuICAgIGZpcnN0QXR0ZW1wdDogbnVtYmVyXHJcbiAgICByZXNldEF0OiBudW1iZXJcclxufVxyXG5cclxuY2xhc3MgUmF0ZUxpbWl0ZXIge1xyXG4gICAgcHJpdmF0ZSBhdHRlbXB0czogTWFwPHN0cmluZywgUmF0ZUxpbWl0RW50cnk+ID0gbmV3IE1hcCgpXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1heEF0dGVtcHRzOiBudW1iZXJcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgd2luZG93TXM6IG51bWJlclxyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1heEF0dGVtcHRzOiBudW1iZXIgPSA1LCB3aW5kb3dNaW51dGVzOiBudW1iZXIgPSAxNSkge1xyXG4gICAgICAgIHRoaXMubWF4QXR0ZW1wdHMgPSBtYXhBdHRlbXB0c1xyXG4gICAgICAgIHRoaXMud2luZG93TXMgPSB3aW5kb3dNaW51dGVzICogNjAgKiAxMDAwXHJcblxyXG4gICAgICAgIC8vIENsZWFudXAgb2xkIGVudHJpZXMgZXZlcnkgNSBtaW51dGVzXHJcbiAgICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5jbGVhbnVwKCksIDUgKiA2MCAqIDEwMDApXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBpZGVudGlmaWVyIGlzIHJhdGUgbGltaXRlZFxyXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgLSBFbWFpbCBvciBJUCBhZGRyZXNzXHJcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIGFsbG93ZWQsIGZhbHNlIGlmIHJhdGUgbGltaXRlZFxyXG4gICAgICovXHJcbiAgICBjaGVjayhpZGVudGlmaWVyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcbiAgICAgICAgY29uc3QgZW50cnkgPSB0aGlzLmF0dGVtcHRzLmdldChpZGVudGlmaWVyKVxyXG5cclxuICAgICAgICBpZiAoIWVudHJ5KSB7XHJcbiAgICAgICAgICAgIC8vIEZpcnN0IGF0dGVtcHRcclxuICAgICAgICAgICAgdGhpcy5hdHRlbXB0cy5zZXQoaWRlbnRpZmllciwge1xyXG4gICAgICAgICAgICAgICAgY291bnQ6IDEsXHJcbiAgICAgICAgICAgICAgICBmaXJzdEF0dGVtcHQ6IG5vdyxcclxuICAgICAgICAgICAgICAgIHJlc2V0QXQ6IG5vdyArIHRoaXMud2luZG93TXMsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB3aW5kb3cgaGFzIGV4cGlyZWRcclxuICAgICAgICBpZiAobm93ID4gZW50cnkucmVzZXRBdCkge1xyXG4gICAgICAgICAgICAvLyBSZXNldCB0aGUgd2luZG93XHJcbiAgICAgICAgICAgIHRoaXMuYXR0ZW1wdHMuc2V0KGlkZW50aWZpZXIsIHtcclxuICAgICAgICAgICAgICAgIGNvdW50OiAxLFxyXG4gICAgICAgICAgICAgICAgZmlyc3RBdHRlbXB0OiBub3csXHJcbiAgICAgICAgICAgICAgICByZXNldEF0OiBub3cgKyB0aGlzLndpbmRvd01zLFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gV2l0aGluIHdpbmRvdyAtIGluY3JlbWVudCBjb3VudFxyXG4gICAgICAgIGlmIChlbnRyeS5jb3VudCA+PSB0aGlzLm1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZSAvLyBSYXRlIGxpbWl0ZWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVudHJ5LmNvdW50KytcclxuICAgICAgICB0aGlzLmF0dGVtcHRzLnNldChpZGVudGlmaWVyLCBlbnRyeSlcclxuICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXQgYXR0ZW1wdHMgZm9yIGFuIGlkZW50aWZpZXIgKGUuZy4sIGFmdGVyIHN1Y2Nlc3NmdWwgbG9naW4pXHJcbiAgICAgKi9cclxuICAgIHJlc2V0KGlkZW50aWZpZXI6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuYXR0ZW1wdHMuZGVsZXRlKGlkZW50aWZpZXIpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgcmVtYWluaW5nIGF0dGVtcHRzIGZvciBhbiBpZGVudGlmaWVyXHJcbiAgICAgKi9cclxuICAgIGdldFJlbWFpbmluZyhpZGVudGlmaWVyOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5hdHRlbXB0cy5nZXQoaWRlbnRpZmllcilcclxuICAgICAgICBpZiAoIWVudHJ5KSByZXR1cm4gdGhpcy5tYXhBdHRlbXB0c1xyXG5cclxuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcbiAgICAgICAgaWYgKG5vdyA+IGVudHJ5LnJlc2V0QXQpIHJldHVybiB0aGlzLm1heEF0dGVtcHRzXHJcblxyXG4gICAgICAgIHJldHVybiBNYXRoLm1heCgwLCB0aGlzLm1heEF0dGVtcHRzIC0gZW50cnkuY291bnQpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGltZSB1bnRpbCByZXNldCBpbiBzZWNvbmRzXHJcbiAgICAgKi9cclxuICAgIGdldFJlc2V0VGltZShpZGVudGlmaWVyOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5hdHRlbXB0cy5nZXQoaWRlbnRpZmllcilcclxuICAgICAgICBpZiAoIWVudHJ5KSByZXR1cm4gMFxyXG5cclxuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcbiAgICAgICAgaWYgKG5vdyA+IGVudHJ5LnJlc2V0QXQpIHJldHVybiAwXHJcblxyXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwoKGVudHJ5LnJlc2V0QXQgLSBub3cpIC8gMTAwMClcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsZWFudXAgZXhwaXJlZCBlbnRyaWVzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2xlYW51cCgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgdGhpcy5hdHRlbXB0cy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgaWYgKG5vdyA+IGVudHJ5LnJlc2V0QXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ZW1wdHMuZGVsZXRlKGtleSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZXMgZm9yIGRpZmZlcmVudCBlbmRwb2ludHNcclxuZXhwb3J0IGNvbnN0IGxvZ2luUmF0ZUxpbWl0ZXIgPSBuZXcgUmF0ZUxpbWl0ZXIoNSwgMTUpIC8vIDUgYXR0ZW1wdHMgcGVyIDE1IG1pbnV0ZXNcclxuZXhwb3J0IGNvbnN0IHJlZ2lzdGVyUmF0ZUxpbWl0ZXIgPSBuZXcgUmF0ZUxpbWl0ZXIoMywgNjApIC8vIDMgcmVnaXN0cmF0aW9ucyBwZXIgaG91clxyXG4iXSwibmFtZXMiOlsiUmF0ZUxpbWl0ZXIiLCJhdHRlbXB0cyIsIk1hcCIsIm1heEF0dGVtcHRzIiwid2luZG93TXMiLCJ3aW5kb3dNaW51dGVzIiwic2V0SW50ZXJ2YWwiLCJjbGVhbnVwIiwiY2hlY2siLCJpZGVudGlmaWVyIiwibm93IiwiRGF0ZSIsImVudHJ5IiwiZ2V0Iiwic2V0IiwiY291bnQiLCJmaXJzdEF0dGVtcHQiLCJyZXNldEF0IiwicmVzZXQiLCJkZWxldGUiLCJnZXRSZW1haW5pbmciLCJNYXRoIiwibWF4IiwiZ2V0UmVzZXRUaW1lIiwiY2VpbCIsImtleSIsImVudHJpZXMiLCJsb2dpblJhdGVMaW1pdGVyIiwicmVnaXN0ZXJSYXRlTGltaXRlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ratelimit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/validation.ts":
/*!***************************!*\
  !*** ./lib/validation.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sanitizeInput: () => (/* binding */ sanitizeInput),\n/* harmony export */   validateEmail: () => (/* binding */ validateEmail),\n/* harmony export */   validatePassword: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/**\r\n * Password validation utilities\r\n */ /**\r\n * Validate password strength with comprehensive rules\r\n * - Minimum 8 characters\r\n * - At least one uppercase letter\r\n * - At least one lowercase letter\r\n * - At least one number\r\n */ function validatePassword(password) {\n    const errors = [];\n    if (!password || password.length < 8) {\n        errors.push('Password minimal 8 karakter');\n    }\n    if (!/[A-Z]/.test(password)) {\n        errors.push('Password harus mengandung minimal 1 huruf besar');\n    }\n    if (!/[a-z]/.test(password)) {\n        errors.push('Password harus mengandung minimal 1 huruf kecil');\n    }\n    if (!/[0-9]/.test(password)) {\n        errors.push('Password harus mengandung minimal 1 angka');\n    }\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validate email format\r\n */ function validateEmail(email) {\n    if (!email) return false;\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n/**\r\n * Sanitize input to prevent XSS\r\n */ function sanitizeInput(input) {\n    if (!input) return '';\n    return input.trim().replace(/[<>]/g, '') // Remove potential HTML tags\n    .slice(0, 500) // Limit length\n    ;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdmFsaWRhdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Q0FFQyxHQU9EOzs7Ozs7Q0FNQyxHQUNNLFNBQVNBLGlCQUFpQkMsUUFBZ0I7SUFDN0MsTUFBTUMsU0FBbUIsRUFBRTtJQUUzQixJQUFJLENBQUNELFlBQVlBLFNBQVNFLE1BQU0sR0FBRyxHQUFHO1FBQ2xDRCxPQUFPRSxJQUFJLENBQUM7SUFDaEI7SUFFQSxJQUFJLENBQUMsUUFBUUMsSUFBSSxDQUFDSixXQUFXO1FBQ3pCQyxPQUFPRSxJQUFJLENBQUM7SUFDaEI7SUFFQSxJQUFJLENBQUMsUUFBUUMsSUFBSSxDQUFDSixXQUFXO1FBQ3pCQyxPQUFPRSxJQUFJLENBQUM7SUFDaEI7SUFFQSxJQUFJLENBQUMsUUFBUUMsSUFBSSxDQUFDSixXQUFXO1FBQ3pCQyxPQUFPRSxJQUFJLENBQUM7SUFDaEI7SUFFQSxPQUFPO1FBQ0hFLE9BQU9KLE9BQU9DLE1BQU0sS0FBSztRQUN6QkQ7SUFDSjtBQUNKO0FBRUE7O0NBRUMsR0FDTSxTQUFTSyxjQUFjQyxLQUFhO0lBQ3ZDLElBQUksQ0FBQ0EsT0FBTyxPQUFPO0lBQ25CLE9BQU8sNkJBQTZCSCxJQUFJLENBQUNHO0FBQzdDO0FBRUE7O0NBRUMsR0FDTSxTQUFTQyxjQUFjQyxLQUFhO0lBQ3ZDLElBQUksQ0FBQ0EsT0FBTyxPQUFPO0lBQ25CLE9BQU9BLE1BQU1DLElBQUksR0FDWkMsT0FBTyxDQUFDLFNBQVMsSUFBSSw2QkFBNkI7S0FDbERDLEtBQUssQ0FBQyxHQUFHLEtBQUssZUFBZTs7QUFDdEMiLCJzb3VyY2VzIjpbIkM6XFx4YW1wcFxcaHRkb2NzXFxncmFreSBzdG9yZSB3ZWJcXGxpYlxcdmFsaWRhdGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUGFzc3dvcmQgdmFsaWRhdGlvbiB1dGlsaXRpZXNcclxuICovXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBhc3N3b3JkVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICB2YWxpZDogYm9vbGVhblxyXG4gICAgZXJyb3JzOiBzdHJpbmdbXVxyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgcGFzc3dvcmQgc3RyZW5ndGggd2l0aCBjb21wcmVoZW5zaXZlIHJ1bGVzXHJcbiAqIC0gTWluaW11bSA4IGNoYXJhY3RlcnNcclxuICogLSBBdCBsZWFzdCBvbmUgdXBwZXJjYXNlIGxldHRlclxyXG4gKiAtIEF0IGxlYXN0IG9uZSBsb3dlcmNhc2UgbGV0dGVyXHJcbiAqIC0gQXQgbGVhc3Qgb25lIG51bWJlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IFBhc3N3b3JkVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cclxuXHJcbiAgICBpZiAoIXBhc3N3b3JkIHx8IHBhc3N3b3JkLmxlbmd0aCA8IDgpIHtcclxuICAgICAgICBlcnJvcnMucHVzaCgnUGFzc3dvcmQgbWluaW1hbCA4IGthcmFrdGVyJylcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIS9bQS1aXS8udGVzdChwYXNzd29yZCkpIHtcclxuICAgICAgICBlcnJvcnMucHVzaCgnUGFzc3dvcmQgaGFydXMgbWVuZ2FuZHVuZyBtaW5pbWFsIDEgaHVydWYgYmVzYXInKVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghL1thLXpdLy50ZXN0KHBhc3N3b3JkKSkge1xyXG4gICAgICAgIGVycm9ycy5wdXNoKCdQYXNzd29yZCBoYXJ1cyBtZW5nYW5kdW5nIG1pbmltYWwgMSBodXJ1ZiBrZWNpbCcpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCEvWzAtOV0vLnRlc3QocGFzc3dvcmQpKSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goJ1Bhc3N3b3JkIGhhcnVzIG1lbmdhbmR1bmcgbWluaW1hbCAxIGFuZ2thJylcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgICAgIGVycm9ycyxcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGVtYWlsIGZvcm1hdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRW1haWwoZW1haWw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCFlbWFpbCkgcmV0dXJuIGZhbHNlXHJcbiAgICByZXR1cm4gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC8udGVzdChlbWFpbClcclxufVxyXG5cclxuLyoqXHJcbiAqIFNhbml0aXplIGlucHV0IHRvIHByZXZlbnQgWFNTXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVJbnB1dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGlmICghaW5wdXQpIHJldHVybiAnJ1xyXG4gICAgcmV0dXJuIGlucHV0LnRyaW0oKVxyXG4gICAgICAgIC5yZXBsYWNlKC9bPD5dL2csICcnKSAvLyBSZW1vdmUgcG90ZW50aWFsIEhUTUwgdGFnc1xyXG4gICAgICAgIC5zbGljZSgwLCA1MDApIC8vIExpbWl0IGxlbmd0aFxyXG59XHJcbiJdLCJuYW1lcyI6WyJ2YWxpZGF0ZVBhc3N3b3JkIiwicGFzc3dvcmQiLCJlcnJvcnMiLCJsZW5ndGgiLCJwdXNoIiwidGVzdCIsInZhbGlkIiwidmFsaWRhdGVFbWFpbCIsImVtYWlsIiwic2FuaXRpemVJbnB1dCIsImlucHV0IiwidHJpbSIsInJlcGxhY2UiLCJzbGljZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/validation.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var C_xampp_htdocs_graky_store_web_app_api_cart_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/cart/route.ts */ \"(rsc)/./app/api/cart/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/cart/route\",\n        pathname: \"/api/cart\",\n        filename: \"route\",\n        bundlePath: \"app/api/cart/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"C:\\\\xampp\\\\htdocs\\\\graky store web\\\\app\\\\api\\\\cart\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_xampp_htdocs_graky_store_web_app_api_cart_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/cart/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZjYXJ0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjYXJ0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2FydCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDeGFtcHAlNUNodGRvY3MlNUNncmFreSUyMHN0b3JlJTIwd2ViJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDeGFtcHAlNUNodGRvY3MlNUNncmFreSUyMHN0b3JlJTIwd2ViJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCZpc0dsb2JhbE5vdEZvdW5kRW5hYmxlZD0hIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2Q7QUFDUztBQUNPO0FBQ0s7QUFDbUM7QUFDakQ7QUFDTztBQUNmO0FBQ3NDO0FBQ3pCO0FBQ007QUFDQztBQUNoQjtBQUN1QjtBQUN6RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCx3QkFBd0IsTUFBdUM7QUFDL0Q7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTiw2QkFBNkIsNkZBQWU7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsMkZBQW1CO0FBQ3JEO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDZFQUFZO0FBQzFCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCB7IGdldFJlcXVlc3RNZXRhIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVxdWVzdC1tZXRhXCI7XG5pbXBvcnQgeyBnZXRUcmFjZXIsIFNwYW5LaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL3RyYWNlclwiO1xuaW1wb3J0IHsgbm9ybWFsaXplQXBwUGF0aCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9yb3V0ZXIvdXRpbHMvYXBwLXBhdGhzXCI7XG5pbXBvcnQgeyBOb2RlTmV4dFJlcXVlc3QsIE5vZGVOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9iYXNlLWh0dHAvbm9kZVwiO1xuaW1wb3J0IHsgTmV4dFJlcXVlc3RBZGFwdGVyLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3NwZWMtZXh0ZW5zaW9uL2FkYXB0ZXJzL25leHQtcmVxdWVzdFwiO1xuaW1wb3J0IHsgQmFzZVNlcnZlclNwYW4gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBnZXRSZXZhbGlkYXRlUmVhc29uIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvaW5zdHJ1bWVudGF0aW9uL3V0aWxzXCI7XG5pbXBvcnQgeyBzZW5kUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9zZW5kLXJlc3BvbnNlXCI7XG5pbXBvcnQgeyBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMsIHRvTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvdXRpbHNcIjtcbmltcG9ydCB7IGdldENhY2hlQ29udHJvbEhlYWRlciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9jYWNoZS1jb250cm9sXCI7XG5pbXBvcnQgeyBJTkZJTklURV9DQUNIRSwgTkVYVF9DQUNIRV9UQUdTX0hFQURFUiB9IGZyb20gXCJuZXh0L2Rpc3QvbGliL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgTm9GYWxsYmFja0Vycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL25vLWZhbGxiYWNrLWVycm9yLmV4dGVybmFsXCI7XG5pbXBvcnQgeyBDYWNoZWRSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXNwb25zZS1jYWNoZVwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXHhhbXBwXFxcXGh0ZG9jc1xcXFxncmFreSBzdG9yZSB3ZWJcXFxcYXBwXFxcXGFwaVxcXFxjYXJ0XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2FydC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NhcnRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NhcnQvcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxceGFtcHBcXFxcaHRkb2NzXFxcXGdyYWt5IHN0b3JlIHdlYlxcXFxhcHBcXFxcYXBpXFxcXGNhcnRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgdmFyIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbDtcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9jYXJ0L3JvdXRlXCI7XG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIHRvIHByb2Nlc3MgZHluYW1pYyByb3V0ZXMgcHJvcGVybHlcbiAgICAvLyBUT0RPOiBmaXggdHVyYm9wYWNrIHByb3ZpZGluZyBkaWZmZXJpbmcgdmFsdWUgZnJvbSB3ZWJwYWNrXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xuICAgICAgICBzcmNQYWdlID0gc3JjUGFnZS5yZXBsYWNlKC9cXC9pbmRleCQvLCAnJykgfHwgJy8nO1xuICAgIH0gZWxzZSBpZiAoc3JjUGFnZSA9PT0gJy9pbmRleCcpIHtcbiAgICAgICAgLy8gd2UgYWx3YXlzIG5vcm1hbGl6ZSAvaW5kZXggc3BlY2lmaWNhbGx5XG4gICAgICAgIHNyY1BhZ2UgPSAnLyc7XG4gICAgfVxuICAgIGNvbnN0IG11bHRpWm9uZURyYWZ0TW9kZSA9IHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREU7XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZSxcbiAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlXG4gICAgfSk7XG4gICAgaWYgKCFwcmVwYXJlUmVzdWx0KSB7XG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xuICAgICAgICByZXMuZW5kKCdCYWQgUmVxdWVzdCcpO1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IGJ1aWxkSWQsIHBhcmFtcywgbmV4dENvbmZpZywgaXNEcmFmdE1vZGUsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0LCBpc09uRGVtYW5kUmV2YWxpZGF0ZSwgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsIHJlc29sdmVkUGF0aG5hbWUgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgY29uc3Qgbm9ybWFsaXplZFNyY1BhZ2UgPSBub3JtYWxpemVBcHBQYXRoKHNyY1BhZ2UpO1xuICAgIGxldCBpc0lzciA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV0gfHwgcHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICBpZiAoaXNJc3IgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNvbnN0IGlzUHJlcmVuZGVyZWQgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgICAgIGNvbnN0IHByZXJlbmRlckluZm8gPSBwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXTtcbiAgICAgICAgaWYgKHByZXJlbmRlckluZm8pIHtcbiAgICAgICAgICAgIGlmIChwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSBmYWxzZSAmJiAhaXNQcmVyZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb0ZhbGxiYWNrRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgY2FjaGVLZXkgPSBudWxsO1xuICAgIGlmIChpc0lzciAmJiAhcm91dGVNb2R1bGUuaXNEZXYgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNhY2hlS2V5ID0gcmVzb2x2ZWRQYXRobmFtZTtcbiAgICAgICAgLy8gZW5zdXJlIC9pbmRleCBhbmQgLyBpcyBub3JtYWxpemVkIHRvIG9uZSBrZXlcbiAgICAgICAgY2FjaGVLZXkgPSBjYWNoZUtleSA9PT0gJy9pbmRleCcgPyAnLycgOiBjYWNoZUtleTtcbiAgICB9XG4gICAgY29uc3Qgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UgPSAvLyBJZiB3ZSdyZSBpbiBkZXZlbG9wbWVudCwgd2UgYWx3YXlzIHN1cHBvcnQgZHluYW1pYyBIVE1MXG4gICAgcm91dGVNb2R1bGUuaXNEZXYgPT09IHRydWUgfHwgLy8gSWYgdGhpcyBpcyBub3QgU1NHIG9yIGRvZXMgbm90IGhhdmUgc3RhdGljIHBhdGhzLCB0aGVuIGl0IHN1cHBvcnRzXG4gICAgLy8gZHluYW1pYyBIVE1MLlxuICAgICFpc0lzcjtcbiAgICAvLyBUaGlzIGlzIGEgcmV2YWxpZGF0aW9uIHJlcXVlc3QgaWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljXG4gICAgLy8gcGFnZSBhbmQgaXQgaXMgbm90IGJlaW5nIHJlc3VtZWQgZnJvbSBhIHBvc3Rwb25lZCByZW5kZXIgYW5kXG4gICAgLy8gaXQgaXMgbm90IGEgZHluYW1pYyBSU0MgcmVxdWVzdCB0aGVuIGl0IGlzIGEgcmV2YWxpZGF0aW9uXG4gICAgLy8gcmVxdWVzdC5cbiAgICBjb25zdCBpc1JldmFsaWRhdGUgPSBpc0lzciAmJiAhc3VwcG9ydHNEeW5hbWljUmVzcG9uc2U7XG4gICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcbiAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgIHJlbmRlck9wdHM6IHtcbiAgICAgICAgICAgIGV4cGVyaW1lbnRhbDoge1xuICAgICAgICAgICAgICAgIGNhY2hlQ29tcG9uZW50czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5jYWNoZUNvbXBvbmVudHMpLFxuICAgICAgICAgICAgICAgIGF1dGhJbnRlcnJ1cHRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmF1dGhJbnRlcnJ1cHRzKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlLFxuICAgICAgICAgICAgaW5jcmVtZW50YWxDYWNoZTogZ2V0UmVxdWVzdE1ldGEocmVxLCAnaW5jcmVtZW50YWxDYWNoZScpLFxuICAgICAgICAgICAgY2FjaGVMaWZlUHJvZmlsZXM6IChfbmV4dENvbmZpZ19leHBlcmltZW50YWwgPSBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbC5jYWNoZUxpZmUsXG4gICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWwsXG4gICAgICAgICAgICBvbkNsb3NlOiAoY2IpPT57XG4gICAgICAgICAgICAgICAgcmVzLm9uKCdjbG9zZScsIGNiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkFmdGVyVGFza0Vycm9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvbkluc3RydW1lbnRhdGlvblJlcXVlc3RFcnJvcjogKGVycm9yLCBfcmVxdWVzdCwgZXJyb3JDb250ZXh0KT0+cm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnJvciwgZXJyb3JDb250ZXh0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KVxuICAgICAgICB9LFxuICAgICAgICBzaGFyZWRDb250ZXh0OiB7XG4gICAgICAgICAgICBidWlsZElkXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG5vZGVOZXh0UmVxID0gbmV3IE5vZGVOZXh0UmVxdWVzdChyZXEpO1xuICAgIGNvbnN0IG5vZGVOZXh0UmVzID0gbmV3IE5vZGVOZXh0UmVzcG9uc2UocmVzKTtcbiAgICBjb25zdCBuZXh0UmVxID0gTmV4dFJlcXVlc3RBZGFwdGVyLmZyb21Ob2RlTmV4dFJlcXVlc3Qobm9kZU5leHRSZXEsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UocmVzKSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaW52b2tlUm91dGVNb2R1bGUgPSBhc3luYyAoc3Bhbik9PntcbiAgICAgICAgICAgIHJldHVybiByb3V0ZU1vZHVsZS5oYW5kbGUobmV4dFJlcSwgY29udGV4dCkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVSZXNwb25zZSA9IGFzeW5jIChjdXJyZW50U3Bhbik9PntcbiAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlR2VuZXJhdG9yID0gYXN5bmMgKHsgcHJldmlvdXNDYWNoZUVudHJ5IH0pPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzT25EZW1hbmRSZXZhbGlkYXRlICYmIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkICYmICFwcmV2aW91c0NhY2hlRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24tZGVtYW5kIHJldmFsaWRhdGUgYWx3YXlzIHNldHMgdGhpcyBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgJ1JFVkFMSURBVEVEJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZW5kKCdUaGlzIHBhZ2UgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGN1cnJlbnRTcGFuKTtcbiAgICAgICAgICAgICAgICAgICAgcmVxLmZldGNoTWV0cmljcyA9IGNvbnRleHQucmVuZGVyT3B0cy5mZXRjaE1ldHJpY3M7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nV2FpdFVudGlsID0gY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWw7XG4gICAgICAgICAgICAgICAgICAgIC8vIEF0dGVtcHQgdXNpbmcgcHJvdmlkZWQgd2FpdFVudGlsIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCB3ZSBmYWxsYmFjayB0byBzZW5kUmVzcG9uc2UncyBoYW5kbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1dhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC53YWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgud2FpdFVudGlsKHBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdXYWl0VW50aWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVUYWdzID0gY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFRhZ3M7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpYyByZXNwb25zZSwgd2UgY2FuIGNhY2hlIGl0IHNvIGxvbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gYXMgaXQncyBub3QgZWRnZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSXNyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSB0aGUgaGVhZGVycyBmcm9tIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlVGFncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbTkVYVF9DQUNIRV9UQUdTX0hFQURFUl0gPSBjYWNoZVRhZ3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddICYmIGJsb2IudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gYmxvYi50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2YWxpZGF0ZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPj0gSU5GSU5JVEVfQ0FDSEUgPyBmYWxzZSA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwaXJlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPj0gSU5GSU5JVEVfQ0FDSEUgPyB1bmRlZmluZWQgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBjYWNoZSBlbnRyeSBmb3IgdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogQnVmZmVyLmZyb20oYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVFbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgcmVzcG9uc2Ugd2l0aG91dCBjYWNoaW5nIGlmIG5vdCBJU1JcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIHJlc3BvbnNlLCBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgYmFja2dyb3VuZCByZXZhbGlkYXRlIHdlIG5lZWQgdG8gcmVwb3J0XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0IGVycm9yIGhlcmUgYXMgaXQgd29uJ3QgYmUgYnViYmxlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNDYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2aW91c0NhY2hlRW50cnkuaXNTdGFsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVQYXRoOiBzcmNQYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSBhd2FpdCByb3V0ZU1vZHVsZS5oYW5kbGVSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgcmVxLFxuICAgICAgICAgICAgICAgIG5leHRDb25maWcsXG4gICAgICAgICAgICAgICAgY2FjaGVLZXksXG4gICAgICAgICAgICAgICAgcm91dGVLaW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgIGlzRmFsbGJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICAgICAgICAgIGlzUm91dGVQUFJFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlT25seUdlbmVyYXRlZCxcbiAgICAgICAgICAgICAgICByZXNwb25zZUdlbmVyYXRvcixcbiAgICAgICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY3JlYXRlIGEgY2FjaGVFbnRyeSBmb3IgSVNSXG4gICAgICAgICAgICBpZiAoIWlzSXNyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGNhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZS5raW5kKSAhPT0gQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSkge1xuICAgICAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTE7XG4gICAgICAgICAgICAgICAgdGhyb3cgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ldyBFcnJvcihgSW52YXJpYW50OiBhcHAtcm91dGUgcmVjZWl2ZWQgaW52YWxpZCBjYWNoZSBlbnRyeSAke2NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZTEgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUxLmtpbmR9YCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFNzAxXCIsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgaXNPbkRlbWFuZFJldmFsaWRhdGUgPyAnUkVWQUxJREFURUQnIDogY2FjaGVFbnRyeS5pc01pc3MgPyAnTUlTUycgOiBjYWNoZUVudHJ5LmlzU3RhbGUgPyAnU1RBTEUnIDogJ0hJVCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJhZnQgbW9kZSBzaG91bGQgbmV2ZXIgYmUgY2FjaGVkXG4gICAgICAgICAgICBpZiAoaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMoY2FjaGVFbnRyeS52YWx1ZS5oZWFkZXJzKTtcbiAgICAgICAgICAgIGlmICghKGdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNJc3IpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5kZWxldGUoTkVYVF9DQUNIRV9UQUdTX0hFQURFUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXQgdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXplIGl0IHZpYSBuZXh0LmNvbmZpZ1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuY2FjaGVDb250cm9sICYmICFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykgJiYgIWhlYWRlcnMuZ2V0KCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNldCgnQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKGNhY2hlRW50cnkudmFsdWUuYm9keSwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBjYWNoZUVudHJ5LnZhbHVlLnN0YXR1cyB8fCAyMDBcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaGFuZGxlUmVzcG9uc2UoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaGFuZGxlUmVzcG9uc2UpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBOb0ZhbGxiYWNrRXJyb3IpKSB7XG4gICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IG5vcm1hbGl6ZWRTcmNQYWdlLFxuICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZXRocm93IHNvIHRoYXQgd2UgY2FuIGhhbmRsZSBzZXJ2aW5nIGVycm9yIHBhZ2VcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBkdXJpbmcgc3RhdGljIGdlbmVyYXRpb24sIHRocm93IHRoZSBlcnJvciBhZ2Fpbi5cbiAgICAgICAgaWYgKGlzSXNyKSB0aHJvdyBlcnI7XG4gICAgICAgIC8vIE90aGVyd2lzZSwgc2VuZCBhIDUwMCByZXNwb25zZS5cbiAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKG51bGwsIHtcbiAgICAgICAgICAgIHN0YXR1czogNTAwXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/mysql2","vendor-chunks/@auth","vendor-chunks/aws-ssl-profiles","vendor-chunks/iconv-lite","vendor-chunks/bcryptjs","vendor-chunks/long","vendor-chunks/next-auth","vendor-chunks/named-placeholders","vendor-chunks/denque","vendor-chunks/is-property","vendor-chunks/lru.min","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/generate-function","vendor-chunks/safer-buffer","vendor-chunks/jose","vendor-chunks/oauth4webapi","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5Cgraky%20store%20web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();